function ra(e){let t=0,r;return()=>{if(t===2)return r;if(t===1)throw new Error("Binding demanded before initialized");return t=1,r=e(),t=2,r}}function u(){throw new Error("Failed pattern match")}function de(e,t){return t>0?Math.floor(e/t):t<0?-Math.floor(e/-t):0}var n_=()=>({tag:"Proxy"}),mt=n_();var j=function(e){return function(t){for(var r=t.length,n=new Array(r),a=0;a<r;a++)n[a]=e(t[a]);return n}};var wr={map:j};var na=e=>e;var aa=function(e){return function(t){for(var r=[],n=0,a=e.length;n<a;n++)Array.prototype.push.apply(r,t(e[n]));return r}};var gt=function(e){return e.toString()};var Rt=(e,t)=>({tag:"Product",_1:e,_2:t});var oa=e=>e,tt=oa("LT"),et=oa("GT"),St=oa("EQ");var R=(e,t)=>({tag:e,_1:t}),G=R("Nothing"),dt=e=>R("Just",e);var $n=e=>{if(e.tag==="Nothing")return!0;if(e.tag==="Just")return!1;u()};var Ve={map:e=>t=>t.tag==="Just"?R("Just",e(t._1)):G};var Pe=e=>{let t=e.Eq0(),r={eq:n=>a=>n.tag==="Nothing"?a.tag==="Nothing":n.tag==="Just"&&a.tag==="Just"&&t.eq(n._1)(a._1)};return{compare:n=>a=>{if(n.tag==="Nothing")return a.tag==="Nothing"?St:tt;if(a.tag==="Nothing")return et;if(n.tag==="Just"&&a.tag==="Just")return e.compare(n._1)(a._1);u()},Eq0:()=>r}};var dn={apply:e=>t=>{if(e.tag==="Just")return t.tag==="Just"?R("Just",e._1(t._1)):G;if(e.tag==="Nothing")return G;u()},Functor0:()=>Ve};var d=(e,t)=>({tag:e,_1:t}),So=e=>d("Left",e),_n=e=>d("Right",e);var ia=e=>{let t=e.Eq0();return r=>{let n=r.Eq0(),a={eq:o=>i=>o.tag==="Left"?i.tag==="Left"&&t.eq(o._1)(i._1):o.tag==="Right"&&i.tag==="Right"&&n.eq(o._1)(i._1)};return{compare:o=>i=>{if(o.tag==="Left")return i.tag==="Left"?e.compare(o._1)(i._1):tt;if(i.tag==="Left")return et;if(o.tag==="Right"&&i.tag==="Right")return r.compare(o._1)(i._1);u()},Eq0:()=>a}}};var $a=e=>e;var da={map:e=>t=>e(t)};var Io={apply:e=>t=>e(t),Functor0:()=>da},c_={bind:e=>t=>t(e),Apply0:()=>Io},s_={pure:$a,Apply0:()=>Io},ir={Applicative0:()=>s_,Bind1:()=>c_};var To=function(e){return function(){return e}},Go=function(e){return function(t){return function(){return t(e())()}}};var _a={Applicative0:()=>Ro,Bind1:()=>p_},p_={bind:Go,Apply0:()=>yo},yo={apply:e=>t=>()=>{let r=e(),n=t();return Ro.pure(r(n))()},Functor0:()=>l_},Ro={pure:To,Apply0:()=>yo},l_={map:e=>t=>()=>{let r=t();return e(r)}};var pt=(e,t)=>({tag:e,_1:t});var un={tailRecM:e=>{let t=r=>{let n=r,a=!0,o;for(;a;){let i=n;if(i.tag==="Loop"){n=e(i._1);continue}if(i.tag==="Done"){a=!1,o=i._1;continue}u()}return o};return r=>t(e(r))},Monad0:()=>ir};var bo=function(e){return function(t){return function(){return e(t())}}},wo=function(e){return function(){return e}};var f_={map:bo};var m_={apply:e=>t=>()=>{let r=e(),n=t();return Mr.pure(r(n))()},Functor0:()=>f_},Mr={pure:wo,Apply0:()=>m_};var ua=function(e){return function(t){return e+t|0}};var ee=function(e){return function(t){if(t===0)return 0;var r=Math.abs(t);return(e%r+r)%r}};var Lo=function(e){return function(t){return t.join(e)}};var kt=e=>t=>({genericShowArgs:r=>[...e.genericShowArgs(r._1),...t.genericShowArgs(r._2)]}),Ct=e=>t=>({"genericShow'":r=>{let n=t.reflectSymbol(mt),a=e.genericShowArgs(r);return a.length===0?n:"("+Lo(" ")([n,...a])+")"}});var F=function(e){throw new Error(e)};var A=(e,t,r)=>({tag:e,_1:t,_2:r});var sn=e=>A("HalfWord",e);var Po=["G","A","S","M"],No=e=>{if(e.tag==="Byte")return[e._1];if(e.tag==="HalfWord")return[ee(e._1)(256),de(e._1,256)];if(e.tag==="Word"){let t=de(e._1,65536),r=ee(e._1)(65536);return[ee(r)(256),de(r,256),ee(t)(256),de(t,256)]}return e.tag==="NamedLabel"?[ee(e._1)(256),de(e._1,256),ee(e._2)(256),de(e._2,256)]:F("Impossible")},sa=e=>{if(e.tag==="Byte")return 1;if(e.tag==="HalfWord")return 2;if(e.tag==="Word"||e.tag==="NamedLabel"||e.tag==="Sym")return 4;u()};var pa=function(e){return function(t){return e===t}},Fo=pa,xo=pa;var la=pa;var qo={eq:la};var fa={eq:xo};var ko={eq:Fo};var ma=function(e){return function(t){return function(r){return function(n){return function(a){return n<a?e:n===a?t:r}}}}},Wo=ma,Bo=ma;var Oo=ma;var Yt={compare:Oo(tt)(St)(et),Eq0:()=>qo};var Zt={compare:Bo(tt)(St)(et),Eq0:()=>fa};var Lr={compare:Wo(tt)(St)(et),Eq0:()=>ko};var pn=(e,t,r)=>({tag:e,_1:t,_2:r});var S_=Pe(Yt).compare,ga=pn("NoLabel");var I_={eq:e=>t=>e.tag==="NoLabel"?t.tag==="NoLabel":e.tag==="CodeLabel"&&t.tag==="CodeLabel"&&(e._1.tag==="Nothing"?t._1.tag==="Nothing":e._1.tag==="Just"&&t._1.tag==="Just"&&e._1._1===t._1._1)&&e._2===t._2},ln={compare:e=>t=>{if(e.tag==="NoLabel")return t.tag==="NoLabel"?St:tt;if(t.tag==="NoLabel")return et;if(e.tag==="CodeLabel"&&t.tag==="CodeLabel"){let r=S_(e._1)(t._1);return r==="LT"?tt:r==="GT"?et:Zt.compare(e._2)(t._2)}u()},Eq0:()=>I_};var Uo=function(t){return function(r){return function(n){return function(){return t(r,n)}}}};var jo=function(e,t){return t.push(e)};var Qo=Uo(jo);var Tt=function(e){return function(t){return function(r){for(var n=t,a=r.length,o=a-1;o>=0;o--)n=e(r[o])(n);return n}}},nt=function(e){return function(t){return function(r){for(var n=t,a=r.length,o=0;o<a;o++)n=e(n)(r[o]);return n}}};var ha=e=>e;var zo=e=>{let t=e.Apply0();return r=>n=>r.foldr(a=>{let o=n(a);return i=>t.apply(t.Functor0().map(c=>na)(o))(i)})(e.pure())},Yo=e=>{let t=zo(e);return r=>{let n=t(r);return a=>o=>n(o)(a)}};var Sa={foldr:e=>t=>r=>{if(r.tag==="Nothing")return t;if(r.tag==="Just")return e(r._1)(t);u()},foldl:e=>t=>r=>{if(r.tag==="Nothing")return t;if(r.tag==="Just")return e(t)(r._1);u()},foldMap:e=>{let t=e.mempty;return r=>n=>{if(n.tag==="Nothing")return t;if(n.tag==="Just")return r(n._1);u()}}};var ft={foldr:Tt,foldl:nt,foldMap:e=>{let t=e.mempty;return r=>ft.foldr(n=>a=>e.Semigroup0().append(r(n))(a))(t)}};var $=(e,t)=>({tag:"Tuple",_1:e,_2:t}),Ut=e=>t=>$(e,t);var Ze=e=>e._2;var $r=e=>e._1;var re=function(e){return function(t){for(var r=t.length,n=Array(r),a=0;a<r;a++)n[a]=e(a)(t[a]);return n}};var ri={mapWithIndex:re,Functor0:()=>wr};var Fe=function(e){return e};var $i=function(){function e(a){return[a]}function t(a){return function(o){return[a,o]}}function r(a){return function(o){return function(i){return[a,o,i]}}}function n(a){return function(o){return a.concat(o)}}return function(a){return function(o){return function(i){return function(c){return function(_){function l(p,m){switch(m-p){case 0:return i([]);case 1:return o(e)(c(_[p]));case 2:return a(o(t)(c(_[p])))(c(_[p+1]));case 3:return a(a(o(r)(c(_[p])))(c(_[p+1])))(c(_[p+2]));default:var f=p+Math.floor((m-p)/4)*2;return a(o(n)(l(p,f)))(l(f,m))}}return l(0,_.length)}}}}}}();var di=e=>e;var Nr={traverse:e=>t=>r=>{if(r.tag==="Nothing")return e.pure(G);if(r.tag==="Just")return e.Apply0().Functor0().map(dt)(t(r._1));u()},sequence:e=>t=>{if(t.tag==="Nothing")return e.pure(G);if(t.tag==="Just")return e.Apply0().Functor0().map(dt)(t._1);u()},Functor0:()=>Ve,Foldable1:()=>Sa};var X={traverse:e=>{let t=e.Apply0();return $i(t.apply)(t.Functor0().map)(e.pure)},sequence:e=>X.traverse(e)(di),Functor0:()=>wr,Foldable1:()=>ft};var iu=function(e,t){if(e<1)return[];var r=new Array(e);return r.fill(t)},$u=function(e,t){for(var r=[],n=0,a=0;a<e;a++)r[n++]=t;return r},du=typeof Array.prototype.fill=="function"?iu:$u;var ut=function(e,t,r){return r.length===0?e({}):t(r[0])(r.slice(1))};var Ie=function(e,t,r,n){for(var a=0,o=n.length;a<o;a++)if(r(n[a]))return e(a);return t};var se=function(e,t,r){return r.slice(e,t)};var v=e=>t=>(()=>{let r=Qo(t);return()=>{let n=[...e];return r(n)(),n}})()();var Te=e=>{let t=e.length-1|0;return t>=0&&t<e.length?R("Just",e[t]):G},fn=e=>dn.apply(e.length===0?G:R("Just",(()=>{let t=se(0,e.length-1|0,e);return r=>({init:t,last:r})})()))(Te(e));var _i=e=>t=>{let n=(a=>{let o=a,i=!0,c;for(;i;){let _=o;if(_>=0&&_<t.length){if(e(t[_])){o=_+1|0;continue}i=!1,c=R("Just",_);continue}i=!1,c=G}return c})(0);if(n.tag==="Just")return n._1===0?{init:[],rest:t}:{init:se(0,n._1,t),rest:se(n._1,t.length,t)};if(n.tag==="Nothing")return{init:t,rest:[]};u()};var dr=e=>t=>{let r=Ie(dt,G,e,t);return r.tag==="Just"?R("Just",t[r._1]):G};var _u=e=>t=>aa(t)(e),uu=e=>_u(t=>{let r=e(t);if(r.tag==="Nothing")return[];if(r.tag==="Just")return[r._1];u()});var mn=uu(e=>e);function ci(e){return e.buffer}function Ge(e){return function(r,n,a){if(n===null)return new e(r);var o=r.byteLength,i=e.BYTES_PER_ELEMENT,c=Math.min(o,n>>>0);if(a===null)return new e(r,c);var _=Math.min((o-c)/i,a);return new e(r,c,_)}}var su=Ge(Uint8ClampedArray),pu=Ge(Uint32Array),lu=Ge(Uint16Array),fu=Ge(Uint8Array),mu=Ge(Int32Array),gu=Ge(Int16Array),Ga=Ge(Int8Array),Du=Ge(Float32Array),hu=Ge(Float64Array);var pm=Number.POSITIVE_INFINITY,lm=Number.NEGATIVE_INFINITY;var si=function(e){return function(t){return function(r){return function(n){return function(a){return function(o){for(var i=[],c=o;;){var _=a(c);i.push(r(_));var l=n(_);if(e(l))return i;c=t(l)}}}}}}};var Ru=e=>{if(e.tag==="Just")return e._1;u()};var pi={unfoldr1:si($n)(Ru)($r)(Ze)};function Ht(e){return e.charCodeAt(0)}function ya(e){return String.fromCharCode(e)}var L=(e,t,r)=>({tag:e,_1:t,_2:r});var jt=L("Nil");var gn={foldr:e=>t=>{let r=gn.foldl(o=>i=>e(i)(o))(t),a=(o=>i=>{let c=o,_=i,l=!0,p;for(;l;){let m=c,f=_;if(f.tag==="Nil"){l=!1,p=m;continue}if(f.tag==="Cons"){c=L("Cons",f._1,m),_=f._2;continue}u()}return p})(jt);return o=>r(a(o))},foldl:e=>r=>n=>{let a=r,o=n,i=!0,c;for(;i;){let _=a,l=o;if(l.tag==="Nil"){i=!1,c=_;continue}if(l.tag==="Cons"){a=e(_)(l._1),o=l._2;continue}u()}return c},foldMap:e=>{let t=e.mempty;return r=>gn.foldl(n=>{let a=e.Semigroup0().append(n);return o=>a(r(o))})(t)}};var mi=function(e){return function(t){return function(r){return function(n){return function(a){return function(o){for(var i=[],c=o;;){var _=a(c);if(e(_))return i;var l=t(_);i.push(r(l)),c=n(l)}}}}}}};var Au=e=>{if(e.tag==="Just")return e._1;u()};var ye={unfoldr:mi($n)(Au)($r)(Ze),Unfoldable10:()=>pi};var Qt=(e,t,r,n,a,o,i)=>({tag:e,_1:t,_2:r,_3:n,_4:a,_5:o,_6:i}),pe=(e,t,r,n)=>({tag:e,_1:t,_2:r,_3:n});var gi=(e,t,r)=>({tag:"SplitLast",_1:e,_2:t,_3:r});var ct=Qt("Leaf");var ur=pe("IterLeaf");var $t=(e,t,r,n)=>{if(r.tag==="Leaf"){if(n.tag==="Leaf")return Qt("Node",1,1,e,t,r,n);if(n.tag==="Node")return Qt("Node",1+n._1|0,1+n._2|0,e,t,r,n);u()}if(r.tag==="Node"){if(n.tag==="Leaf")return Qt("Node",1+r._1|0,1+r._2|0,e,t,r,n);if(n.tag==="Node")return Qt("Node",r._1>n._1?1+r._1|0:1+n._1|0,(1+r._2|0)+n._2|0,e,t,r,n)}u()};var He=(e,t,r,n)=>{if(r.tag==="Leaf")return n.tag==="Leaf"?Qt("Node",1,1,e,t,ct,ct):n.tag==="Node"&&n._1>1?n._5.tag==="Node"&&(()=>{if(n._6.tag==="Leaf")return n._5._1>0;if(n._6.tag==="Node")return n._5._1>n._6._1;u()})()?$t(n._5._3,n._5._4,$t(e,t,r,n._5._5),$t(n._3,n._4,n._5._6,n._6)):$t(n._3,n._4,$t(e,t,r,n._5),n._6):$t(e,t,r,n);if(r.tag==="Node")return n.tag==="Node"?n._1>(r._1+1|0)?n._5.tag==="Node"&&(()=>{if(n._6.tag==="Leaf")return n._5._1>0;if(n._6.tag==="Node")return n._5._1>n._6._1;u()})()?$t(n._5._3,n._5._4,$t(e,t,r,n._5._5),$t(n._3,n._4,n._5._6,n._6)):$t(n._3,n._4,$t(e,t,r,n._5),n._6):r._1>(n._1+1|0)?r._6.tag==="Node"&&(()=>{if(r._5.tag==="Leaf")return 0<=r._6._1;if(r._5.tag==="Node")return r._5._1<=r._6._1;u()})()?$t(r._6._3,r._6._4,$t(r._3,r._4,r._5,r._6._5),$t(e,t,r._6._6,n)):$t(r._3,r._4,r._5,$t(e,t,r._6,n)):$t(e,t,r,n):n.tag==="Leaf"&&r._1>1?r._6.tag==="Node"&&(()=>{if(r._5.tag==="Leaf")return 0<=r._6._1;if(r._5.tag==="Node")return r._5._1<=r._6._1;u()})()?$t(r._6._3,r._6._4,$t(r._3,r._4,r._5,r._6._5),$t(e,t,r._6._6,n)):$t(r._3,r._4,r._5,$t(e,t,r._6,n)):$t(e,t,r,n);u()};var Di=(e,t,r,n)=>{if(n.tag==="Leaf")return gi(e,t,r);if(n.tag==="Node"){let a=Di(n._3,n._4,n._5,n._6);return gi(a._1,a._2,He(e,t,r,a._3))}u()},hi=(e,t)=>{if(e.tag==="Leaf")return t;if(e.tag==="Node"){let r=Di(e._3,e._4,e._5,e._6);return He(r._1,r._2,r._3,t)}u()};var hn=e=>t=>r=>{let n=a=>{if(a.tag==="Leaf")return ct;if(a.tag==="Node"){let o=e.compare(r)(a._3);if(o==="LT")return He(a._3,a._4,n(a._5),a._6);if(o==="GT")return He(a._3,a._4,a._5,n(a._6));if(o==="EQ"){let i=t(a._4);if(i.tag==="Nothing")return hi(a._5,a._6);if(i.tag==="Just")return Qt("Node",a._1,a._2,a._3,i._1,a._5,a._6)}}u()};return n};var Vt=e=>t=>n=>{let a=n,o=!0,i;for(;o;){let c=a;if(c.tag==="Leaf"){o=!1,i=G;continue}if(c.tag==="Node"){let _=e.compare(t)(c._3);if(_==="LT"){a=c._5;continue}if(_==="GT"){a=c._6;continue}if(_==="EQ"){o=!1,i=R("Just",c._4);continue}}u()}return i};var bu=e=>t=>n=>{let a=n,o=!0,i;for(;o;){let c=a;if(c.tag==="IterLeaf"){o=!1,i=t();continue}if(c.tag==="IterEmit"){o=!1,i=e(c._1,c._2,c._3);continue}if(c.tag==="IterNode"){a=(l=>p=>{let m=l,f=p,D=!0,s;for(;D;){let S=m,g=f;if(g.tag==="Leaf"){D=!1,s=S;continue}if(g.tag==="Node"){if(g._6.tag==="Leaf"){m=pe("IterEmit",g._3,g._4,S),f=g._5;continue}m=pe("IterEmit",g._3,g._4,pe("IterNode",g._6,S)),f=g._5;continue}u()}return s})(c._2)(c._1);continue}u()}return i};var cr=bu((e,t,r)=>R("Just",$($(e,t),r)))(e=>G);var Gt=e=>t=>r=>{let n=a=>{if(a.tag==="Leaf")return Qt("Node",1,1,t,r,ct,ct);if(a.tag==="Node"){let o=e.compare(t)(a._3);if(o==="LT")return He(a._3,a._4,n(a._5),a._6);if(o==="GT")return He(a._3,a._4,a._5,n(a._6));if(o==="EQ")return Qt("Node",a._1,a._2,t,r,a._5,a._6)}u()};return n};var xr=e=>t=>{let r=n=>{if(n.tag==="Leaf")return ct;if(n.tag==="Node")return t(n._3)(n._4)?He(n._3,n._4,r(n._5),r(n._6)):hi(r(n._5),r(n._6));u()};return r};var Sn=e=>t=>t.foldl(r=>n=>Gt(e)(n._1)(n._2)(r))(ct);var Si=function(e){return function(t){return e.length===0?t:t.length===0?e:e.concat(t)}};var Ii={append:Si};var Ra={mempty:[],Semigroup0:()=>Ii};var qe=function(e){return function(t){if(e>=0&&e<t.length)return t.charAt(e);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var sr=function(e){return e.split("")},In=function(e){return e};var pr=function(e){return e.length};var Tn=function(e){return function(t){return t.substr(0,e)}},ve=function(e){return function(t){return t.substring(e)}};var Ca=e=>e===""?G:R("Just",{head:qe(0)(e),tail:ve(1)(e)});var Gi=(()=>{let e=ye.unfoldr(cr);return t=>e(pe("IterNode",t,ur))})(),yi=Yo(Mr)(ft),Mu=(()=>{let e=X.traverse(Mr);return t=>r=>e(r)(t)})(),tr=ft.foldMap(Ra)(ha),Ri=nt(ua)(0),Lu=ft.foldMap(Ra),Gn=e=>{if(e.tag==="KLabel")return 0;if(e.tag==="KQuote"){if(e._1.tag==="ACUnit")return 0;if(e._1.tag==="ACBool")return 2;if(e._1.tag==="ACInt")return 5;u()}return e.tag==="KGetGlobal"||e.tag==="KSetGlobal"?5:e.tag==="KField"?2:e.tag==="KMakeBlock"?3:e.tag==="KAccess"?2:e.tag==="KClosure"?5:e.tag==="KEndLet"||e.tag==="KDummies"||e.tag==="KUpdate"?2:e.tag==="KBranch"||e.tag==="KBranchIf"||e.tag==="KBranchIfNot"?3:e.tag==="KBranchIfNotImm"?7:e.tag==="KBranchIfNotTag"||e.tag==="KBranchIfEqTag"?4:1},Ci=e=>t=>r=>{let n=(a,o)=>{let i=Vt(ln)(o)(t);return i.tag==="Just"?[...a,A("HalfWord",i._1-e|0)]:F("Impossible!")};return a=>{let o=()=>{let i=c=>{if(a.tag==="KClosure"){if(a._1.tag==="CodeLabel"&&a._1._1.tag==="Just")return F("Impossible: Closure referencing Undefined labels");u()}if(a.tag==="KApply")return[A("Byte",129)];if(a.tag==="KPush")return[A("Byte",131)];if(a.tag==="KPushMark")return[A("Byte",132)];if(a.tag==="KGrab")return[A("Byte",133)];if(a.tag==="KReturn")return[A("Byte",96)];if(a.tag==="KTailApply")return[A("Byte",102)];if(a.tag==="KAccess")return[A("Byte",225),A("Byte",a._1)];if(a.tag==="KLet")return[A("Byte",226)];if(a.tag==="KEndLet")return[A("Byte",227),A("Byte",a._1)];if(a.tag==="KDummies")return[A("Byte",228),A("Byte",a._1)];if(a.tag==="KUpdate")return[A("Byte",229),A("Byte",a._1)];if(a.tag==="K_i32_add")return[A("Byte",161)];if(a.tag==="K_i32_sub")return[A("Byte",162)];if(a.tag==="K_i32_mul")return[A("Byte",163)];if(a.tag==="K_i32_div")return[A("Byte",164)];if(a.tag==="K_i32_mod")return[A("Byte",165)];if(a.tag==="K_i32_equ")return[A("Byte",166)];if(a.tag==="K_i32_neq")return[A("Byte",167)];if(a.tag==="K_i32_le")return[A("Byte",168)];if(a.tag==="K_i32_lt")return[A("Byte",169)];if(a.tag==="K_log_and")return[A("Byte",170)];if(a.tag==="K_log_or")return[A("Byte",171)];if(a.tag==="K_log_xor")return[A("Byte",172)];if(a.tag==="K_log_not")return[A("Byte",173)];if(a.tag==="KBranch")return n([A("Byte",176)],a._1);if(a.tag==="KBranchIf")return n([A("Byte",177)],a._1);if(a.tag==="KBranchIfNot")return n([A("Byte",178)],a._1);if(a.tag==="KBranchIfNotImm")return a._1.tag==="ACInt"?n([A("Byte",180),A("Word",a._1._1)],a._2):a._1.tag==="ACBool"?a._1._1?n([A("Byte",179),A("Byte",1)],a._2):n([A("Byte",179),A("Byte",0)],a._2):F("Impossible: KBranchIfNotImm unit");if(a.tag==="KBranchIfNotTag")return n([A("Byte",181),A("Byte",a._1)],a._2);if(a.tag==="KBranchIfEqTag")return n([A("Byte",182),A("Byte",a._1)],a._2);u()};if(a.tag==="KClosure"&&a._1.tag==="CodeLabel"&&a._1._1.tag==="Just"){let c=a._1._1._1,_=Ie(dt,G,l=>l===c,r);if(_.tag==="Just")return[A("Byte",128),A("NamedLabel",_._1,a._1._2)]}return i(!0)};if(a.tag==="KNoop")return[A("Byte",254)];if(a.tag==="KStop")return[A("Byte",255)];if(a.tag==="KExit")return[A("Byte",238)];if(a.tag==="KLabel")return[];if(a.tag==="KQuote"){if(a._1.tag==="ACUnit")return[];if(a._1.tag==="ACBool")return a._1._1?[A("Byte",192),A("Byte",1)]:[A("Byte",192),A("Byte",0)];if(a._1.tag==="ACInt")return[A("Byte",193),A("Word",a._1._1)];u()}if(a.tag==="KGetGlobal")return[A("Byte",200),A("Sym",a._1)];if(a.tag==="KSetGlobal")return[A("Byte",201),A("Sym",a._1)];if(a.tag==="KField")return[A("Byte",202),A("Byte",a._1)];if(a.tag==="KMakeBlock")return[A("Byte",203),(()=>{if(a._1.tag==="TTuple")return A("Byte",0);if(a._1.tag==="TConstr")return A("Byte",a._1._1);u()})(),A("Byte",a._2)];if(a.tag==="KClosure"){if(a._1.tag==="NoLabel")return F("Impossible: Closure referencing not-a-label");if(a._1.tag==="CodeLabel"&&a._1._1.tag==="Nothing")return F("Impossible: Closure referencing null-namespace label")}return o()}},Ai=e=>{let t=(()=>{let n=nt(a=>{let o=a._2,i=a._1;return c=>c.tag==="KLabel"?$(i,Gt(ln)(c._1)(i)(o)):$(i+Gn(c)|0,o)})($(0,ct))(e.init)._2;return()=>{let a=0,o=[];yi(e.init)(c=>()=>{let _=a;return o.push(...Ci(_)(n)(j(Fe)(e.syms))(c)),a=a+Gn(c)|0})();let i=[...o];return $(i,(()=>{let c=j(Fe)(e.syms);return j(_=>{if(_._1.tag==="CodeLabel")return[(()=>{let l=(()=>{if(_._1._1.tag==="Just"){let p=_._1._1._1;return Ie(dt,G,m=>m===p,c)}if(_._1._1.tag==="Nothing")return G;u()})();if(l.tag==="Nothing")return-1;if(l.tag==="Just")return l._1;u()})(),_._1._2,0+_._2|0];u()})(Gi(n))})())}})()(),r=(()=>{let n=ct,a=0,o=[],i=Mu(e.text)(l=>{let p=l._1.code,m=l._1.lbl;return()=>{let f=a,D=n;n=Gt(Yt)(m)(f)(D);let s=nt(T=>{let M=T._2,h=T._1;return C=>C.tag==="KLabel"?$(h,Gt(ln)(C._1)(h)(M)):$(h+Gn(C)|0,M)})($(0,ct))(p)._2,S=0;yi(p)(T=>()=>{let M=S;return o.push(...Ci(M)(s)(j(Fe)(e.syms))(T)),S=S+Gn(T)|0})(),a=a+S|0;let b=j(Fe)(e.syms);return j(T=>{if(T._1.tag==="CodeLabel")return[(()=>{let M=(()=>{if(T._1._1.tag==="Just"){let h=T._1._1._1;return Ie(dt,G,C=>C===h,b)}if(T._1._1.tag==="Nothing")return G;u()})();if(M.tag==="Nothing")return-1;if(M.tag==="Just")return M._1;u()})(),T._1._2,f+T._2|0];u()})(Gi(s))}})(),c=[...o];return $(n,$(c,tr(i)))})();return{header:{name:e.name,compilerVersion:"v0.1.0"},text:r._2._1,entry:t._1,syms:j(Fe)(e.syms),lbls:[...t._2,...r._2._2]}},bi=e=>{let t=tr([[...j(n=>A("Byte",Ht(n)))(sr(e.header.name)),A("Byte",0)],[...j(n=>A("Byte",Ht(n)))(sr(e.header.compilerVersion)),A("Byte",0)]]),r=Lu(n=>No((()=>{if(n.tag==="Sym"){let a=n._1,o=Ie(dt,G,i=>i===a,e.syms);if(o.tag==="Just")return A("Word",o._1)}return n.tag==="Sym"?F("Impossible: undefined symbol"):n})()))(tr([tr([j(n=>A("Byte",Ht(n)))(Po),[A("Byte",5+t.length|0)],t]),tr((()=>{let n=[e.text,e.entry,[A("HalfWord",e.syms.length),...tr((()=>{let o=j(c=>[...j(_=>A("Byte",Ht(_)))(sr(c)),A("Byte",0)])(e.syms),i=j(sn)(nt(c=>_=>{let l=Te(c);return v(c)((()=>{if(l.tag==="Just")return l._1;u()})()+Ri(j(sa)(_))|0)})([0])(o));return[(i.length===0&&u(),se(0,i.length-1|0,i)),...o]})())],j(sn)(tr(e.lbls))],a=j(sn)(nt(o=>i=>{let c=Te(o);return v(o)((()=>{if(c.tag==="Just")return c._1;u()})()+Ri(j(sa)(i))|0)})([0])(n));return[(a.length===0&&u(),se(0,a.length-1|0,a)),...n]})())]));return()=>{let n=Ga(r,null,null);return ci(n)}};var Y=e=>({bind:t=>r=>n=>e.Bind1().bind(t(n))(a=>r(a._1)(a._2)),Apply0:()=>le(e)}),le=e=>{let t=e.Bind1().Apply0().Functor0(),r={map:n=>a=>o=>t.map(i=>$(n(i._1),i._2))(a(o))};return{apply:(()=>{let n=Y(e);return a=>o=>n.bind(a)(i=>n.bind(o)(c=>z(e).pure(i(c))))})(),Functor0:()=>r}},z=e=>({pure:t=>r=>e.Applicative0().pure($(t,r)),Apply0:()=>le(e)});var Aa=e=>{let t=e.Monad0(),r={Applicative0:()=>z(t),Bind1:()=>Y(t)};return{ask:(()=>{let n=e.ask;return a=>t.Bind1().bind(n)(o=>t.Applicative0().pure($(o,a)))})(),Monad0:()=>r}},wi=e=>{let t=Aa(e.MonadAsk0());return{local:r=>{let n=e.local(r);return a=>o=>n(a(o))},MonadAsk0:()=>t}};var yn=e=>{let t=e.Monad0(),r={Applicative0:()=>z(t),Bind1:()=>Y(t)};return{tailRecM:n=>a=>o=>e.tailRecM(i=>t.Bind1().bind(n(i._1)(i._2))(c=>t.Applicative0().pure((()=>{if(c._1.tag==="Loop")return pt("Loop",$(c._1._1,c._2));if(c._1.tag==="Done")return pt("Done",$(c._1._1,c._2));u()})())))($(a,o)),Monad0:()=>r}},At=e=>{let t={Applicative0:()=>z(e),Bind1:()=>Y(e)};return{state:r=>n=>e.Applicative0().pure(r(n)),Monad0:()=>t}};var lr=e=>{let t=e.Monad0(),r={Applicative0:()=>z(t),Bind1:()=>Y(t)};return{throwError:n=>{let a=e.throwError(n);return o=>t.Bind1().bind(a)(i=>t.Applicative0().pure($(i,o)))},Monad0:()=>r}};var Rn=(e,t)=>({tag:"SourceDelta",_1:e,_2:t}),ne=(e,t)=>({tag:"SourcePos",_1:e,_2:t});var er={from:ne(0,0),to:ne(0,0)};var Ei=(()=>{let e=nt(t=>r=>r===`
`?t._1===0?Rn(1,0):Rn(t._1+1|0,0):Rn(t._1,t._2+1|0))(Rn(0,0));return t=>e(sr(t))})();var Mi=function(e){return function(t){return function(r){return function(n){try{return t(new RegExp(r,n))}catch(a){return e(a.message)}}}}};var ae=function(e){return function(t){var r=e.lastIndex,n=e.test(t);return e.lastIndex=r,n}},Li=function(e){return function(t){return function(r){return function(n){var a=n.match(r);if(a==null||a.length===0)return t;for(var o=0;o<a.length;o++)a[o]=a[o]==null?t:e(a[o]);return e(a)}}}};var Pi=e=>t=>Mi(So)(_n)(e)((t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.dotAll?"s":"")+(t.sticky?"y":"")+(t.unicode?"u":""));var Ni=Li(dt)(G);var Cn={global:!1,ignoreCase:!1,multiline:!1,dotAll:!1,sticky:!1,unicode:!0};var An=e=>t=>{let r=Pi(e)(t);if(r.tag==="Left")return F(r._1);if(r.tag==="Right")return r._1;u()};var Re=(e,t)=>({tag:e,_1:t}),st=(e,t)=>({tag:"Qualified",_1:e,_2:t}),Nu={reflectSymbol:()=>"Qualified"};var mr=Re("Compiler");var wn=e=>t=>st(e,t);var Wr={show:e=>"(TypeName (Ident "+e+"))"},En={show:e=>"(ConstructorName (Ident "+e+"))"};var We=e=>({show:(()=>{let t=Ct(kt({genericShowArgs:r=>["(ModuleName "+r+")"]})({genericShowArgs:r=>[e.show(r)]}))(Nu);return r=>t["genericShow'"](Rt(r._1,r._2))})()});var Fu={eq:e=>t=>e===t},Br={compare:e=>t=>Yt.compare(e)(t),Eq0:()=>Fu};var Wt=e=>{let t=e.Eq0(),r={eq:n=>a=>n._1===a._1&&t.eq(n._2)(a._2)};return{compare:n=>a=>{let o=Yt.compare(n._1)(a._1);return o==="LT"?tt:o==="GT"?et:e.compare(n._2)(a._2)},Eq0:()=>r}},ki={eq:e=>t=>e===t},xu={eq:e=>t=>e===t},oe={compare:e=>t=>Yt.compare(e)(t),Eq0:()=>ki},Be={compare:e=>t=>Yt.compare(e)(t),Eq0:()=>xu};var fe=An("^[A-Z][a-zA-Z0-9'_]*$")(Cn);var wa=e=>e,Or=(e,t)=>({tag:e,_1:t}),Mn=(e,t)=>({tag:e,_1:t}),gr=e=>({tag:"KndType",_1:e}),Wi=(e,t,r)=>({tag:e,_1:t,_2:r}),E=(e,t,r,n)=>({tag:e,_1:t,_2:r,_3:n});var Bi=e=>t=>E("TTup",e,t);var Oi=Mn("TTuple");var Ki=Or("ACUnit");var Ji=wa("RightAssoc"),ie=wa("LeftAssoc"),Kr=wa("NonAssoc");var Ce={map:e=>t=>{if(t.tag==="TGlobal")return E("TGlobal",e(t._1),t._2);if(t.tag==="TFunc")return E("TFunc",e(t._1),Ce.map(e)(t._2),Ce.map(e)(t._3));if(t.tag==="TTup")return E("TTup",e(t._1),j(Ce.map(e))(t._2));if(t.tag==="TVar")return E("TVar",e(t._1),t._2);u()}};var qu={eq:e=>t=>e.tag==="ACUnit"?t.tag==="ACUnit":e.tag==="ACBool"?t.tag==="ACBool"&&e._1===t._1:e.tag==="ACInt"&&t.tag==="ACInt"&&e._1===t._1};var Ui={compare:e=>t=>{if(e.tag==="ACUnit")return t.tag==="ACUnit"?St:tt;if(t.tag==="ACUnit")return et;if(e.tag==="ACBool")return t.tag==="ACBool"?Lr.compare(e._1)(t._1):tt;if(t.tag==="ACBool")return et;if(e.tag==="ACInt"&&t.tag==="ACInt")return Zt.compare(e._1)(t._1);u()},Eq0:()=>qu};var k=(e,t,r)=>({tag:e,_1:t,_2:r});var ji=k("KStop"),Pn=k("KExit");var Qi=k("KApply"),Vi=k("KTailApply"),zi=k("KGrab"),Nn=k("KPush"),Yi=k("KPushMark"),Ea=k("KReturn");var Zi=k("KLet");var Hi=k("K_i32_add"),Xi=k("K_i32_sub"),vi=k("K_i32_mul"),t$=k("K_i32_div"),e$=k("K_i32_mod"),r$=k("K_i32_equ"),n$=k("K_i32_neq"),a$=k("K_i32_le"),o$=k("K_i32_lt"),i$=k("K_log_and"),$$=k("K_log_or"),d$=k("K_log_xor"),_$=k("K_log_not");var u$=e=>t=>k("KBranchIfNotImm",e,t);var s$=e=>({tag:"CodeSection",_1:e});var ge=At(ir),W=Y(ir),qn=ge.state(e=>$(e,e)),Ma=Pe(Yt),ot=z(ir),Bu=yn(un).tailRecM;var Oe=W.bind(qn)(e=>{let t=Vt(Ma)(e.ns)(e.next);if(t.tag==="Just"){let r=t._1;return W.bind((()=>{let n={...e,next:hn(Ma)(a=>R("Just",a+1|0))(e.ns)(e.next)};return ge.state(a=>$(void 0,n))})())(()=>ot.pure(pn("CodeLabel",e.ns,r)))}if(t.tag==="Nothing")return W.bind((()=>{let r={...e,next:Gt(Ma)(e.ns)(1)(e.next)};return ge.state(n=>$(void 0,r))})())(()=>ot.pure(pn("CodeLabel",e.ns,0)));u()}),p$=e=>(r=>n=>{let a=r,o=n,i=!0,c;for(;i;){let _=a,l=o;if(_===0){i=!1,c=l;continue}a=_-1|0,o=L("Cons",zi,l)}return c})(e),xn=e=>{if(e.tag==="Cons"){if(e._1.tag==="KReturn")return ot.pure($(Ea,e));if(e._1.tag==="KBranch")return ot.pure($(e._1,e))}return W.bind(Oe)(t=>ot.pure($(k("KBranch",t),L("Cons",k("KLabel",t),e))))};var Ou=e=>t=>r=>e.tag==="CodeLabel"&&e._1.tag==="Nothing"?F("Impossible"):W.bind(qn)(n=>W.bind((()=>{let a={...n,more:L("Cons",{lbl:e,arity:t,term:r},n.more)};return ge.state(o=>$(void 0,a))})())(()=>ot.pure(e))),La=e=>t=>{let r=o=>i=>{if(o.tag==="ELVar")return ot.pure(L("Cons",k("KAccess",o._2),i));if(o.tag==="ELConst"){if(o._2.tag==="SCAtom")return ot.pure(L("Cons",k("KQuote",o._2._1),i));if(o._2.tag==="SCBlock")return F("Not implemented");u()}if(o.tag==="ELApp"&&i.tag==="Cons"&&i._1.tag==="KReturn")return W.bind(r(o._2)(L("Cons",Vi,i._2)))(c=>a(o._3)(L("Cons",Nn,c)));if(o.tag==="ELApp"){let c=o._3;return W.bind(r(o._2)(L("Cons",Qi,i)))(_=>{let l=a(c)(L("Cons",Nn,_));return p=>{let m=l(p);return $(L("Cons",Yi,m._1),m._2)}})}if(o.tag==="ELAbs"){if(i.tag==="Cons"&&i._1.tag==="KReturn"){let l=p$(o._2),p=r(o._3)(i);return m=>{let f=p(m);return $(l(f._1),f._2)}}let c=o._2,_=o._3;return W.bind((()=>{let l=W.bind(Oe)(p=>W.bind(Oe)(m=>Ou(p)(c)(_)));return W.bind(p=>{let m=qn(p);return $(m._1.ns,m._2)})(p=>W.bind(ge.state(m=>$(void 0,{...m,ns:R("Just",e)})))(()=>W.bind(l)(m=>W.bind(ge.state(f=>$(void 0,{...f,ns:p})))(()=>ot.pure(m)))))})())(l=>ot.pure(L("Cons",k("KClosure",l),i)))}if(o.tag==="ELLet"){let c=o._2;return W.bind(r(o._3)(i.tag==="Cons"&&i._1.tag==="KReturn"?i:L("Cons",k("KEndLet",c.length),i)))(_=>{let l=p=>{let m=ut(f=>G,f=>D=>R("Just",{head:f,tail:D}),p);if(m.tag==="Nothing")return ot.pure(_);if(m.tag==="Just"){let f=m._1.head;return W.bind((()=>{let D=l(m._1.tail);return s=>{let S=D(s);return $(L("Cons",Zi,S._1),S._2)}})())(D=>r(f)(D))}u()};return l(c)})}if(o.tag==="ELLetRec")return F("Not implemented: letrec");if(o.tag==="ELPrim")return o._2.tag==="PGetGlobal"?ot.pure(L("Cons",k("KGetGlobal",o._2._2),i)):o._2.tag==="PSetGlobal"&&o._3.length===1?r(o._3[0])(L("Cons",k("KSetGlobal",o._2._2),i)):o._2.tag==="PSetGlobal"?F("Impossible"):o._2.tag==="PMakeBlock"?a(o._3)(L("Cons",k("KMakeBlock",o._2._1,o._3.length),i)):a(o._3)(o._2.tag==="PField"?L("Cons",k("KField",o._2._1),i):o._2.tag==="P_i32_add"?L("Cons",Hi,i):o._2.tag==="P_i32_sub"?L("Cons",Xi,i):o._2.tag==="P_i32_mul"?L("Cons",vi,i):o._2.tag==="P_i32_div"?L("Cons",t$,i):o._2.tag==="P_i32_mod"?L("Cons",e$,i):o._2.tag==="P_i32_equ"?L("Cons",r$,i):o._2.tag==="P_i32_neq"?L("Cons",n$,i):o._2.tag==="P_i32_le"?L("Cons",a$,i):o._2.tag==="P_i32_lt"?L("Cons",o$,i):o._2.tag==="P_log_and"?L("Cons",i$,i):o._2.tag==="P_log_or"?L("Cons",$$,i):o._2.tag==="P_log_not"&&i.tag==="Cons"&&i._1.tag==="KBranchIf"?L("Cons",k("KBranchIfNot",i._1._1),i._2):o._2.tag==="P_log_not"&&i.tag==="Cons"&&i._1.tag==="KBranchIfNot"?L("Cons",k("KBranchIf",i._1._1),i._2):o._2.tag==="P_log_not"?L("Cons",_$,i):o._2.tag==="P_log_xor"?L("Cons",d$,i):F("Impoissible"));if(o.tag==="ELIf")return n(o._2)(o._3)(o._4)(i);if(o.tag==="ELCond"){let c=o._3,_=o._2;return W.bind(xn(i))(l=>{let p=l._1,m=l._2,f=D=>{let s=ut(S=>G,S=>g=>R("Just",{head:S,tail:g}),D);if(s.tag==="Nothing")return F("Impossible");if(s.tag==="Just"&&s._1.tail.length===0){let S=u$(s._1.head._1),g=r(s._1.head._2)(m);return I=>{let b=g(I);return $(t.tag==="CodeLabel"?L("Cons",S(t),b._1):L("Cons",Pn,b._1),b._2)}}if(s.tag==="Just"){let S=s._1.head._1,g=s._1.head._2,I=s._1.tail;return W.bind(Oe)(b=>W.bind(f(I))(T=>{let M=r(g)(L("Cons",p,L("Cons",k("KLabel",b),T)));return h=>{let C=M(h);return $(L("Cons",k("KBranchIfNotImm",S,b),C._1),C._2)}}))}u()};return W.bind(f(c))(D=>r(_)(D))})}if(o.tag==="ELSwitch"){let c=o._3,_=o._2;return W.bind(xn(i))(l=>{let p=l._1,m=l._2,f=D=>{let s=ut(S=>G,S=>g=>R("Just",{head:S,tail:g}),D);if(s.tag==="Nothing")return F("Impossible");if(s.tag==="Just"&&s._1.tail.length===0)return W.bind(Oe)(S=>W.bind(r(s._1.head._2)(m))(g=>ot.pure(L("Cons",k("KBranchIfEqTag",s._1.head._1,S),L("Cons",Pn,L("Cons",k("KLabel",S),g))))));if(s.tag==="Just"){let S=s._1.head._2,g=s._1.tail,I=s._1.head._1;return W.bind(Oe)(b=>W.bind(f(g))(T=>{let M=r(S)(L("Cons",p,L("Cons",k("KLabel",b),T)));return h=>{let C=M(h);return $(L("Cons",k("KBranchIfNotTag",I,b),C._1),C._2)}}))}u()};return W.bind(f(c))(D=>r(_)(D))})}if(o.tag==="ELTrap"&&o._3.tag==="ELRaise")return r(o._2)(i);if(o.tag==="ELTrap"){let c=o._2,_=o._3;return W.bind(xn(i))(l=>{let p=l._1;return W.bind(r(_)(l._2))(m=>W.bind(Oe)(f=>La(e)(f)(c)(L("Cons",p,L("Cons",k("KLabel",f),m)))))})}if(o.tag==="ELRaise"&&t.tag==="CodeLabel")return ot.pure(L("Cons",k("KBranch",t),i));if(o.tag==="ELRaise")return ot.pure(L("Cons",Pn,i));u()},n=o=>i=>c=>_=>W.bind(xn(_))(l=>{let p=l._1,m=l._2;return W.bind(Oe)(f=>W.bind(r(c)(m))(D=>W.bind(r(i)(L("Cons",p,L("Cons",k("KLabel",f),D))))(s=>r(o)(L("Cons",k("KBranchIfNot",f),s)))))}),a=o=>i=>{let c=ut(_=>G,_=>l=>R("Just",{head:_,tail:l}),o);if(c.tag==="Nothing")return ot.pure(i);if(c.tag==="Just"&&c._1.tail.length===0)return r(c._1.head)(i);if(c.tag==="Just"){let _=c._1.tail;return W.bind(r(c._1.head)(i))(l=>a(_)(L("Cons",Nn,l)))}u()};return r},Ku=e=>{let t=e.ident,r=e.term,n=W.bind(qn)(c=>Nr.traverse(ot)(_=>{let l=_.head;return W.bind((()=>{let p={...c,more:_.tail};return ge.state(m=>$(void 0,p))})())(()=>ot.pure(l))})((()=>{if(c.more.tag==="Nil")return G;if(c.more.tag==="Cons")return R("Just",{head:c.more._1,tail:c.more._2});u()})())),a=c=>W.bind(n)(_=>{if(_.tag==="Just"&&_._1.lbl.tag==="CodeLabel"&&_._1.lbl._1.tag==="Just")return W.bind(La(_._1.lbl._1._1)(ga)(_._1.term)(L("Cons",Ea,c)))(l=>_._1.arity===1?a(L("Cons",k("KLabel",_._1.lbl),l)):a(L("Cons",k("KLabel",_._1.lbl),p$(_._1.arity-1|0)(l))));if(_.tag==="Just")return F("Impossible");if(_.tag==="Nothing")return ot.pure(c);u()}),o=W.bind(ge.state(c=>$(void 0,{...c,ns:R("Just",t)})))(()=>W.bind(a(jt))(c=>ot.pure(s$({lbl:t,code:(l=>p=>{let m=l,f=p,D=!0,s;for(;D;){let S=m,g=f;if(g.tag==="Nil"){D=!1,s=S;continue}if(g.tag==="Cons"){m=v(S)(g._1),f=g._2;continue}u()}return s})([])(c)})))),i=W.bind(ge.state(c=>$(void 0,{...c,ns:G})))(()=>W.bind(La(t)(ga)(r)(t==="it"?L("Cons",ji,jt):L("Cons",k("KSetGlobal",t),jt)))(c=>ot.pure((l=>p=>{let m=l,f=p,D=!0,s;for(;D;){let S=m,g=f;if(g.tag==="Nil"){D=!1,s=S;continue}if(g.tag==="Cons"){m=v(S)(g._1),f=g._2;continue}u()}return s})([])(c))));return W.bind(ge.state(c=>$(void 0,{...c,more:jt})))(()=>W.bind(i)(c=>W.bind(o)(_=>ot.pure({init:c,text:_}))))},Ju=e=>Bu(t=>{let r=ut(n=>G,n=>a=>R("Just",{head:n,tail:a}),t._1);if(r.tag==="Nothing")return ot.pure(pt("Done",t._2));if(r.tag==="Just"){if(r._1.head.tag==="NonRec"){let n=r._1.head._1.ident;return W.bind(Ku({ident:n,term:r._1.head._1.term}))(a=>ot.pure(pt("Loop",$(r._1.tail,{...t._2,text:a.text._1.code.length>0?v(t._2.text)(a.text):t._2.text,init:[...t._2.init,...a.init],syms:v(t._2.syms)(n)}))))}if(r._1.head.tag==="Rec")return F("Not implemented!")}u()})($(e.decls,{name:e.name,text:[],data:[],init:[],refs:[],syms:[]})),l$=e=>Ju(e)({moduleName:e.name,next:Qt("Node",1,1,G,0,ct,ct),init:[],more:jt,ns:G})._1;var Pt=(e,t,r)=>({tag:e,_1:t,_2:r});var f$=Pt("P_i32_add"),m$=Pt("P_i32_sub"),g$=Pt("P_i32_mul"),D$=Pt("P_i32_div");var h$=Pt("P_i32_equ"),S$=Pt("P_i32_neq"),I$=Pt("P_i32_le"),T$=Pt("P_i32_lt");var Bt=(e,t)=>({tag:e,_1:t});var Jr=(()=>{let e=ye.unfoldr(cr);return t=>e(pe("IterNode",t,ur))})(),Wn=Wt(oe),Pa=Wt(Be);var y$=e=>t=>{let r=dr(n=>n._1._2===e)(Jr(xr(Wn)(n=>a=>a.opened)(t.globals)));return r.tag==="Just"?R("Just",$(r._1._1,r._1._2.desc)):G},R$=e=>t=>{let r=dr(n=>n._2.opened&&n._1._2===t)(Jr(e.aliases));return r.tag==="Just"?R("Just",r._1._2):G};var vt=wn("Base"),rr=vt("Bool");var rt=vt("Int");var zu=Sn(Wt(Be))(ft)([$(rt,{kind:gr(void 0),opened:!0,constrs:[]}),$(rr,{kind:gr(void 0),opened:!0,constrs:[]})]),A$=vt("intAdd"),b$=vt("intDiv"),w$=vt("intEqu"),E$=vt("intGE"),M$=vt("intGT"),L$=vt("intLE"),P$=vt("intLT"),N$=vt("intMul"),F$=vt("intNeq"),x$=vt("intSub"),Yu=Sn(Wt(oe))(ft)([$(A$,{desc:Bt("Prim",{prim:f$}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rt))),opened:!0}),$(N$,{desc:Bt("Prim",{prim:g$}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rt))),opened:!0}),$(x$,{desc:Bt("Prim",{prim:m$}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rt))),opened:!0}),$(b$,{desc:Bt("Prim",{prim:D$}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rt))),opened:!0}),$(w$,{desc:Bt("Prim",{prim:h$}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rr))),opened:!0}),$(F$,{desc:Bt("Prim",{prim:S$}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rr))),opened:!0}),$(L$,{desc:Bt("Prim",{prim:I$}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rr))),opened:!0}),$(P$,{desc:Bt("Prim",{prim:T$}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rr))),opened:!0}),$(E$,{desc:Bt("Normal",{}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rr))),opened:!0}),$(M$,{desc:Bt("Normal",{}),typ:E("TFunc",void 0,E("TGlobal",void 0,rt),E("TFunc",void 0,E("TGlobal",void 0,rt),E("TGlobal",void 0,rr))),opened:!0})]);var Zu=Sn(Wt(Br))(ft)([$(st("Base","+"),{realname:A$,assoc:ie,prec:6,opened:!0}),$(st("Base","*"),{realname:N$,assoc:ie,prec:7,opened:!0}),$(st("Base","/"),{realname:b$,assoc:ie,prec:7,opened:!0}),$(st("Base","-"),{realname:x$,assoc:ie,prec:6,opened:!0}),$(st("Base","=="),{realname:w$,assoc:Kr,prec:4,opened:!0}),$(st("Base","/="),{realname:F$,assoc:Kr,prec:4,opened:!0}),$(st("Base","<"),{realname:P$,assoc:ie,prec:4,opened:!0}),$(st("Base","<="),{realname:L$,assoc:ie,prec:4,opened:!0}),$(st("Base",">"),{realname:M$,assoc:ie,prec:4,opened:!0}),$(st("Base",">="),{realname:E$,assoc:ie,prec:4,opened:!0})]),q$={types:zu,globals:Yu,aliases:Zu};var Xu=e=>t=>r=>t(e(r));var vu=e=>{let t=e.Apply0(),r=t.Functor0(),n=(()=>{let a={map:o=>{let i=r.map(o);return c=>_=>i(c(_))}};return{apply:o=>i=>c=>t.apply(o(c))(i(c)),Functor0:()=>a}})();return{bind:a=>o=>i=>e.bind(a(i))(c=>o(c)(i)),Apply0:()=>n}};var Ur=e=>{let t=e.Applicative0(),r=t.Apply0(),n=(()=>{let o=r.Functor0(),i={map:_=>{let l=o.map(_);return p=>m=>l(p(m))}},c={apply:_=>l=>p=>r.apply(_(p))(l(p)),Functor0:()=>i};return{pure:_=>{let l=t.pure(_);return p=>l},Apply0:()=>c}})(),a=vu(e.Bind1());return{Applicative0:()=>n,Bind1:()=>a}};var k$=e=>{let t=Ur(e),r={ask:e.Applicative0().pure,Monad0:()=>t};return{local:Xu,MonadAsk0:()=>r}};var W$=(e,t)=>({tag:e,_1:t}),_t=(e,t,r,n,a)=>({tag:e,_1:t,_2:r,_3:n,_4:a});var B$=e=>t=>r=>_t("ELPrim",e,t,r);var O$=e=>t=>r=>_t("ELCond",e,t,r),K$=e=>t=>r=>_t("ELSwitch",e,t,r),J$=e=>t=>r=>n=>_t("ELIf",e,t,r,n);var U$=e=>t=>r=>_t("ELTrap",e,t,r);var jr={foldrWithIndex:e=>t=>{let r=Tt(a=>{let o=a._1,i=a._2;return c=>e(o)(i)(c)})(t),n=re(Ut);return a=>r(n(a))},foldlWithIndex:e=>t=>{let r=nt(a=>o=>e(o._1)(a)(o._2))(t),n=re(Ut);return a=>r(n(a))},foldMapWithIndex:e=>{let t=e.mempty;return r=>jr.foldrWithIndex(n=>a=>o=>e.Semigroup0().append(r(n)(a))(o))(t)},Foldable0:()=>ft};var Na=(e,t,r)=>({tag:e,_1:t,_2:r});var rc=We(En).show,nc=We(Wr).show,Fa=Na("TNull");var Q$=e=>t=>{let r=t.Monad0(),n=t.ask;return a=>{let o=i=>c=>{let _=i,l=c,p=!0,m;for(;p;){let f=_,D=l;if(D.tag==="TNull"){p=!1,m=F("Impossible: unknown local variable (Ident "+a+")");continue}if(D.tag==="TEnv"){let s=Vt(oe)(a)(D._1);if(s.tag==="Just"){p=!1,m=$(f,s._1);continue}}if(D.tag==="TEnv"){_=f+1|0,l=D._2;continue}u()}return m};return r.Bind1().bind(n)(i=>r.Applicative0().pure(o(0)(i.locals)))}},xa=e=>{let t=e.Monad0(),r=e.state(n=>$(n,n));return n=>t.Bind1().bind(r)(a=>{let o=Vt(Wt(Be))(n)(a.genv.types);if(o.tag==="Nothing")return F("Impossible: unknown type");if(o.tag==="Just")return t.Applicative0().pure(o._1);u()})},qa=e=>{let t=e.Monad0(),r=e.state(n=>$(n,n));return n=>t.Bind1().bind(r)(a=>{let o=Vt(Wt(oe))(n)(a.genv.globals);if(o.tag==="Nothing")return F("Impossible: unknown global");if(o.tag==="Just")return t.Applicative0().pure(o._1);u()})},ka=e=>{let t=e.Monad0(),r=qa(e);return n=>t.Bind1().bind(r(st(n._1,n._2)))(a=>a.desc.tag==="Constructor"?t.Applicative0().pure(a.desc._1):F("Impossible: Not a constructor"))},V$=e=>{let t=e.Monad0(),r=t.Bind1(),n=ka(e),a=xa(e);return o=>r.bind(n(o))(i=>r.bind(a(i.typname))(c=>{let _=Ie(dt,G,l=>l._1===i.name._1&&l._2===i.name._2,c.constrs);if(_.tag==="Nothing")return F("Impossible: "+rc(o)+" is not a constructor of given type "+nc(i.typname));if(_.tag==="Just")return t.Applicative0().pure(_._1);u()}))},z$=e=>t=>{let r=a=>o=>{let i=(c,_)=>jr.foldlWithIndex(l=>p=>m=>r(p)(L("Cons",l,c))(m))(a)(_);return c=>{if(c.tag==="PatWildcard"||c.tag==="PatConst")return a;if(c.tag==="PatVar")return Gt(oe)(c._2)(o)(a);if(c.tag==="PatTyped")return r(a)(o)(c._2);if(c.tag==="PatConstructor")return i(o,c._4);if(c.tag==="PatTuple")return i(o,c._2);if(c.tag==="PatAlias")return r(Gt(oe)(c._3)(o)(a))(o)(c._2);u()}},n=r(ct)(jt);return e.local(a=>({...a,locals:nt(o=>i=>Na("TEnv",n(i),o))(a.locals)(t)}))},Wa=e=>t=>r=>n=>e.local(a=>({...a,locals:Na("TEnv",Qt("Node",1,1,t,r,ct,ct),a.locals)}))(n);var Ka=(e,t)=>({tag:"AnnExpr",_1:e,_2:t}),Y$=(e,t)=>({tag:e,_1:t}),J=(e,t,r,n,a)=>({tag:e,_1:t,_2:r,_3:n,_4:a}),it=(e,t,r,n,a)=>({tag:e,_1:t,_2:r,_3:n,_4:a});var Ja=e=>e;var Z$=e=>t=>it("PatTuple",e,t);var H$=e=>t=>r=>it("PatAlias",e,t,r),X$=e=>t=>r=>it("PatTyped",e,t,r);var v$=e=>t=>J("ExprTuple",e,t);var td=e=>t=>r=>n=>J("ExprFunc",e,t,r,n);var ed=e=>t=>r=>n=>J("ExprLet",e,t,r,n);var rd=e=>t=>r=>n=>J("ExprIf",e,t,r,n),nd=e=>t=>J("ExprMatch",e,t),ad=e=>t=>r=>J("ExprTyped",e,t,r);var od=e=>e,id=e=>t=>Ka(e,t);var hr={map:e=>t=>{if(t.tag==="PatWildcard")return it("PatWildcard",e(t._1));if(t.tag==="PatVar")return it("PatVar",e(t._1),t._2);if(t.tag==="PatConst")return it("PatConst",e(t._1),t._2);if(t.tag==="PatTuple")return it("PatTuple",e(t._1),j(hr.map(e))(t._2));if(t.tag==="PatConstructor")return it("PatConstructor",e(t._1),t._2,t._3,j(hr.map(e))(t._4));if(t.tag==="PatAlias")return it("PatAlias",e(t._1),hr.map(e)(t._2),t._3);if(t.tag==="PatTyped")return it("PatTyped",e(t._1),hr.map(e)(t._2),t._3);u()}},$d={map:e=>t=>({...t,heads:j(bt.map(e))(t.heads),matrix:j(r=>({...r,act:bt.map(e)(r.act),pats:j(hr.map(e))(r.pats)}))(t.matrix)})},bt={map:e=>t=>{if(t.tag==="ExprConst")return J("ExprConst",e(t._1),t._2);if(t.tag==="ExprVar")return J("ExprVar",e(t._1),t._2);if(t.tag==="ExprGlobal")return J("ExprGlobal",e(t._1),t._2);if(t.tag==="ExprTuple")return J("ExprTuple",e(t._1),j(bt.map(e))(t._2));if(t.tag==="ExprField")return J("ExprField",e(t._1),bt.map(e)(t._2),t._3);if(t.tag==="ExprFunc")return J("ExprFunc",e(t._1),t._2,t._3,bt.map(e)(t._4));if(t.tag==="ExprApp")return J("ExprApp",e(t._1),bt.map(e)(t._2),bt.map(e)(t._3));if(t.tag==="ExprLet")return J("ExprLet",e(t._1),t._2,bt.map(e)(t._3),bt.map(e)(t._4));if(t.tag==="ExprConstructor")return J("ExprConstructor",e(t._1),t._2,j(bt.map(e))(t._3));if(t.tag==="ExprIf")return J("ExprIf",e(t._1),bt.map(e)(t._2),bt.map(e)(t._3),bt.map(e)(t._4));if(t.tag==="ExprMatch")return J("ExprMatch",e(t._1),$d.map(e)(t._2));if(t.tag==="ExprTyped")return J("ExprTyped",e(t._1),bt.map(e)(t._2),t._3);u()}},wt={foldl:e=>t=>r=>{if(r.tag==="PatWildcard"||r.tag==="PatVar"||r.tag==="PatConst")return e(t)(r._1);if(r.tag==="PatTuple")return nt(wt.foldl(e))(e(t)(r._1))(r._2);if(r.tag==="PatConstructor")return nt(wt.foldl(e))(e(t)(r._1))(r._4);if(r.tag==="PatAlias"||r.tag==="PatTyped")return wt.foldl(e)(e(t)(r._1))(r._2);u()},foldr:e=>t=>r=>{if(r.tag==="PatWildcard"||r.tag==="PatVar"||r.tag==="PatConst")return e(r._1)(t);if(r.tag==="PatTuple")return e(r._1)(Tt((()=>{let n=wt.foldr(e);return a=>o=>n(o)(a)})())(t)(r._2));if(r.tag==="PatConstructor")return e(r._1)(Tt((()=>{let n=wt.foldr(e);return a=>o=>n(o)(a)})())(t)(r._4));if(r.tag==="PatAlias"||r.tag==="PatTyped")return e(r._1)(wt.foldr(e)(t)(r._2));u()},foldMap:e=>{let t=e.Semigroup0(),r=ft.foldMap(e);return n=>a=>{if(a.tag==="PatWildcard"||a.tag==="PatVar"||a.tag==="PatConst")return n(a._1);if(a.tag==="PatTuple")return t.append(n(a._1))(r(wt.foldMap(e)(n))(a._2));if(a.tag==="PatConstructor")return t.append(n(a._1))(r(wt.foldMap(e)(n))(a._4));if(a.tag==="PatAlias"||a.tag==="PatTyped")return t.append(n(a._1))(wt.foldMap(e)(n)(a._2));u()}}},Dr={traverse:e=>{let t=e.Apply0(),r=t.Functor0(),n=X.traverse(e);return a=>o=>{if(o.tag==="PatWildcard")return r.map(i=>it("PatWildcard",i))(a(o._1));if(o.tag==="PatVar"){let i=o._2;return r.map(c=>it("PatVar",c,i))(a(o._1))}if(o.tag==="PatConst"){let i=o._2;return r.map(c=>it("PatConst",c,i))(a(o._1))}if(o.tag==="PatTuple")return t.apply(r.map(i=>c=>it("PatTuple",i,c))(a(o._1)))(n(Dr.traverse(e)(a))(o._2));if(o.tag==="PatConstructor"){let i=o._2,c=o._3;return t.apply(r.map(_=>l=>it("PatConstructor",_,i,c,l))(a(o._1)))(n(Dr.traverse(e)(a))(o._4))}if(o.tag==="PatAlias"){let i=o._3;return t.apply(r.map(c=>_=>it("PatAlias",c,_,i))(a(o._1)))(Dr.traverse(e)(a)(o._2))}if(o.tag==="PatTyped"){let i=o._3;return t.apply(r.map(c=>_=>it("PatTyped",c,_,i))(a(o._1)))(Dr.traverse(e)(a)(o._2))}u()}},sequence:e=>t=>Dr.traverse(e)(Ja)(t),Functor0:()=>hr,Foldable1:()=>wt},Bn={foldl:e=>t=>r=>nt(n=>a=>nt(wt.foldl(e))(O.foldl(e)(n)(a.act))(a.pats))(nt(O.foldl(e))(t)(r.heads))(r.matrix),foldr:e=>t=>r=>Tt((()=>{let n=O.foldr(e);return a=>o=>n(o)(a)})())(Tt(n=>a=>O.foldr(e)(Tt(o=>i=>wt.foldr(e)(i)(o))(a)(n.pats))(n.act))(t)(r.matrix))(r.heads),foldMap:e=>{let t=e.Semigroup0(),r=ft.foldMap(e),n=wt.foldMap(e);return a=>o=>t.append(r(O.foldMap(e)(a))(o.heads))(r(i=>t.append(O.foldMap(e)(a)(i.act))(r(n(a))(i.pats)))(o.matrix))}},O={foldl:e=>t=>r=>{if(r.tag==="ExprConst"||r.tag==="ExprVar"||r.tag==="ExprGlobal")return e(t)(r._1);if(r.tag==="ExprTuple")return nt(O.foldl(e))(e(t)(r._1))(r._2);if(r.tag==="ExprField")return O.foldl(e)(e(t)(r._1))(r._2);if(r.tag==="ExprFunc")return O.foldl(e)(e(t)(r._1))(r._4);if(r.tag==="ExprApp")return O.foldl(e)(O.foldl(e)(e(t)(r._1))(r._2))(r._3);if(r.tag==="ExprLet")return O.foldl(e)(O.foldl(e)(e(t)(r._1))(r._3))(r._4);if(r.tag==="ExprConstructor")return nt(O.foldl(e))(e(t)(r._1))(r._3);if(r.tag==="ExprIf")return O.foldl(e)(O.foldl(e)(O.foldl(e)(e(t)(r._1))(r._2))(r._3))(r._4);if(r.tag==="ExprMatch")return Bn.foldl(e)(e(t)(r._1))(r._2);if(r.tag==="ExprTyped")return O.foldl(e)(e(t)(r._1))(r._2);u()},foldr:e=>t=>r=>{if(r.tag==="ExprConst"||r.tag==="ExprVar"||r.tag==="ExprGlobal")return e(r._1)(t);if(r.tag==="ExprTuple")return e(r._1)(Tt((()=>{let n=O.foldr(e);return a=>o=>n(o)(a)})())(t)(r._2));if(r.tag==="ExprField")return e(r._1)(O.foldr(e)(t)(r._2));if(r.tag==="ExprFunc")return e(r._1)(O.foldr(e)(t)(r._4));if(r.tag==="ExprApp")return e(r._1)(O.foldr(e)(O.foldr(e)(t)(r._3))(r._2));if(r.tag==="ExprLet")return e(r._1)(O.foldr(e)(O.foldr(e)(t)(r._4))(r._3));if(r.tag==="ExprConstructor")return e(r._1)(Tt((()=>{let n=O.foldr(e);return a=>o=>n(o)(a)})())(t)(r._3));if(r.tag==="ExprIf")return e(r._1)(O.foldr(e)(O.foldr(e)(O.foldr(e)(t)(r._4))(r._3))(r._2));if(r.tag==="ExprMatch")return e(r._1)(Bn.foldr(e)(t)(r._2));if(r.tag==="ExprTyped")return e(r._1)(O.foldr(e)(t)(r._2));u()},foldMap:e=>{let t=e.Semigroup0(),r=ft.foldMap(e);return n=>a=>{if(a.tag==="ExprConst"||a.tag==="ExprVar"||a.tag==="ExprGlobal")return n(a._1);if(a.tag==="ExprTuple")return t.append(n(a._1))(r(O.foldMap(e)(n))(a._2));if(a.tag==="ExprField")return t.append(n(a._1))(O.foldMap(e)(n)(a._2));if(a.tag==="ExprFunc")return t.append(n(a._1))(O.foldMap(e)(n)(a._4));if(a.tag==="ExprApp")return t.append(n(a._1))(t.append(O.foldMap(e)(n)(a._2))(O.foldMap(e)(n)(a._3)));if(a.tag==="ExprLet")return t.append(n(a._1))(t.append(O.foldMap(e)(n)(a._3))(O.foldMap(e)(n)(a._4)));if(a.tag==="ExprConstructor")return t.append(n(a._1))(r(O.foldMap(e)(n))(a._3));if(a.tag==="ExprIf")return t.append(n(a._1))(t.append(O.foldMap(e)(n)(a._2))(t.append(O.foldMap(e)(n)(a._3))(O.foldMap(e)(n)(a._4))));if(a.tag==="ExprMatch")return t.append(n(a._1))(Bn.foldMap(e)(n)(a._2));if(a.tag==="ExprTyped")return t.append(n(a._1))(O.foldMap(e)(n)(a._2));u()}}},dd={traverse:e=>{let t=e.Apply0(),r=t.Functor0(),n=X.traverse(e),a=Dr.traverse(e);return o=>i=>t.apply(r.map(c=>_=>({...i,heads:c,matrix:_}))(n(yt.traverse(e)(o))(i.heads)))(n(c=>t.apply(r.map(_=>l=>({...c,act:_,pats:l}))(yt.traverse(e)(o)(c.act)))(n(a(o))(c.pats)))(i.matrix))},sequence:e=>t=>dd.traverse(e)(Ja)(t),Functor0:()=>$d,Foldable1:()=>Bn},yt={traverse:e=>{let t=e.Apply0(),r=t.Functor0(),n=X.traverse(e);return a=>o=>{if(o.tag==="ExprConst"){let i=o._2;return r.map(c=>J("ExprConst",c,i))(a(o._1))}if(o.tag==="ExprVar"){let i=o._2;return r.map(c=>J("ExprVar",c,i))(a(o._1))}if(o.tag==="ExprGlobal"){let i=o._2;return r.map(c=>J("ExprGlobal",c,i))(a(o._1))}if(o.tag==="ExprTuple")return t.apply(r.map(i=>c=>J("ExprTuple",i,c))(a(o._1)))(n(yt.traverse(e)(a))(o._2));if(o.tag==="ExprField"){let i=o._3;return t.apply(r.map(c=>_=>J("ExprField",c,_,i))(a(o._1)))(yt.traverse(e)(a)(o._2))}if(o.tag==="ExprFunc"){let i=o._2,c=o._3;return t.apply(r.map(_=>l=>J("ExprFunc",_,i,c,l))(a(o._1)))(yt.traverse(e)(a)(o._4))}if(o.tag==="ExprApp")return t.apply(t.apply(r.map(i=>c=>_=>J("ExprApp",i,c,_))(a(o._1)))(yt.traverse(e)(a)(o._2)))(yt.traverse(e)(a)(o._3));if(o.tag==="ExprLet"){let i=o._2;return t.apply(t.apply(r.map(c=>_=>l=>J("ExprLet",c,i,_,l))(a(o._1)))(yt.traverse(e)(a)(o._3)))(yt.traverse(e)(a)(o._4))}if(o.tag==="ExprConstructor"){let i=o._2;return t.apply(r.map(c=>_=>J("ExprConstructor",c,i,_))(a(o._1)))(n(yt.traverse(e)(a))(o._3))}if(o.tag==="ExprIf")return t.apply(t.apply(t.apply(r.map(i=>c=>_=>l=>J("ExprIf",i,c,_,l))(a(o._1)))(yt.traverse(e)(a)(o._2)))(yt.traverse(e)(a)(o._3)))(yt.traverse(e)(a)(o._4));if(o.tag==="ExprMatch")return t.apply(r.map(i=>c=>J("ExprMatch",i,c))(a(o._1)))(dd.traverse(e)(a)(o._2));if(o.tag==="ExprTyped"){let i=o._3;return t.apply(r.map(c=>_=>J("ExprTyped",c,_,i))(a(o._1)))(yt.traverse(e)(a)(o._2))}u()}},sequence:e=>t=>yt.traverse(e)(Ja)(t),Functor0:()=>bt,Foldable1:()=>O};var Sr=(e,t,r)=>({tag:e,_1:t,_2:r});var ud=(()=>{let e=ye.unfoldr(cr);return t=>e(pe("IterNode",t,ur))})(),Ua=ia(Ui)(Zt);var cd=Sr("Fail");var oc=e=>t=>Sr("Conditional",e,t),ic=e=>t=>Sr("JumpThru",e,t);var $c=e=>{let t=e,r=!0,n;for(;r;){let a=t;if(a.tag==="PatAlias"){t=a._2;continue}if(a.tag==="PatTyped"){t=a._2;continue}if(a.tag==="PatConst"){r=!1,n=R("Just",d("Left",a._2));continue}if(a.tag==="PatConstructor"){r=!1,n=R("Just",d("Right",a._3));continue}r=!1,n=G}return n},ja=e=>e.tag==="PatWildcard"||e.tag==="PatVar"?!0:(e.tag==="PatAlias"||e.tag==="PatTyped")&&ja(e._2),dc=e=>{let t=_i(r=>0<r.pats.length&&ja(r.pats[0]))(e.matrix);return $({heads:se(1,e.heads.length,e.heads),matrix:j(r=>({...r,pats:se(1,r.pats.length,r.pats)}))(t.init)},{heads:e.heads,matrix:t.rest})},_c=e=>{let t=e.Monad0(),r=t.Applicative0(),n=t.Bind1(),a=xa(e),o=ka(e);return i=>{let c=ut(_=>G,_=>l=>R("Just",{head:_,tail:l}),i.heads);if(c.tag==="Nothing")return F("Impossible: cannot decompose 0-width matrix");if(c.tag==="Just"){let _=c._1.tail,l=c._1.head,p=m=>f=>{let D=ut(s=>G,s=>S=>R("Just",{head:s,tail:S}),f);if(D.tag==="Nothing")return r.pure($(ud(m),{heads:i.heads,matrix:[]}));if(D.tag==="Just"){let s=ut(S=>G,S=>g=>R("Just",{head:S,tail:g}),D._1.head.pats);if(s.tag==="Nothing")return F("Impossible");if(s.tag==="Just"){let S=$c(s._1.head);if(S.tag==="Nothing")return r.pure($(ud(m),{...i,matrix:f}));if(S.tag==="Just"){let g=S._1;return n.bind((b=>{let T=b,M=!0,h;for(;M;){let C=T;if(C.tag==="PatTyped"){T=C._2;continue}if(C.tag==="PatAlias"){T=C._2;continue}if(C.tag==="PatConst"){M=!1,h=r.pure($(_,{pats:s._1.tail,act:D._1.head.act}));continue}if(C.tag==="PatConstructor"){let N=C._4,y=C._3;M=!1,h=n.bind(a(C._2))(U=>y>=0&&y<U.constrs.length?n.bind(o(U.constrs[y]))(Q=>r.pure($([...re(he=>qt=>J("ExprField",Ka(er,Ce.map(Ue=>({src:mr}))(qt)),l,he))(Q.argTypes),..._],{pats:[...N,...s._1.tail],act:D._1.head.act}))):F("Impossible: constructor is not a member of the type"));continue}M=!1,h=F("Impossible: classify always-matched pattern")}return h})(s._1.head))(I=>{let b=Vt(Ua)(g)(m);if(b.tag==="Just"){let T={heads:I._1,matrix:v(b._1.matrix)(I._2)};return p(hn(Ua)(M=>R("Just",T))(g)(m))(D._1.tail)}return p(Gt(Ua)(g)({heads:I._1,matrix:[I._2]})(m))(D._1.tail)})}}}u()};return n.bind(p(ct)(i.matrix))(m=>r.pure({matchHead:l,jumpTbl:m._1,restMatrix:m._2}))}u()}},sd=e=>{let t=e.Monad0(),r=t.Applicative0(),n=t.Bind1(),a=_c(e),o=n.Apply0(),i=o.Functor0(),c=X.traverse(r);return _=>{let l=m=>{let f=ut(D=>G,D=>s=>R("Just",{head:D,tail:s}),m.matrix);if(f.tag==="Nothing")return r.pure(cd);if(f.tag==="Just"&&m.heads.length===0&&f._1.head.pats.length===0)return r.pure(Sr("Leaf",f._1.head.act));if(f.tag==="Just"){let D=dc(m),s=D._1;return n.bind(a(D._2))(S=>{let g=S.restMatrix;return n.bind(p(S.matchHead)(S.jumpTbl))(I=>n.bind(o.apply(i.map(b=>T=>b.tag==="Fail"?T:T.tag==="Fail"||b.tag==="Leaf"?b:Sr("Choice",b,T))(l(s)))(r.pure(I)))(b=>i.map(T=>b.tag==="Fail"?T:T.tag==="Fail"||b.tag==="Leaf"?b:Sr("Choice",b,T))(l(g))))})}u()},p=m=>f=>{let s=(S=>g=>I=>{let b=S,T=g,M=I,h=!0,C;for(;h;){let N=b,y=T,Q=ut(he=>G,he=>qt=>R("Just",{head:he,tail:qt}),M);if(Q.tag==="Nothing"){h=!1,C={conditional:N,switch:y};continue}if(Q.tag==="Just"){if(Q._1.head._1.tag==="Right"){b=N,T=v(y)($(Q._1.head._1._1,Q._1.head._2)),M=Q._1.tail;continue}if(Q._1.head._1.tag==="Left"){b=v(N)($(Q._1.head._1._1,Q._1.head._2)),T=y,M=Q._1.tail;continue}}u()}return C})([])([])(f);return s.conditional.length===0&&s.switch.length===0?r.pure(cd):s.switch.length===0?i.map(oc(m))(c(S=>i.map(Ut(S._1))(l(S._2)))(s.conditional)):s.conditional.length===0?i.map(ic(m))(c(S=>i.map(Ut(S._1))(l(S._2)))(s.switch)):F("Impossible: Mixed toplevel discriminator")};return l({..._,matrix:re(m=>f=>({...f,act:m}))(_.matrix)})}};var On=typeof module>"u"?void 0:module.require,pd=function(){try{return On===void 0?void 0:On("util")}catch{return}}();function Qa(e,t){return pd!==void 0?console.log(e+":",pd.inspect(t,{depth:null,colors:!0})):console.log(e+":",t),t}var _D=function(){var e;if(typeof performance<"u")e=performance;else if(On)try{e=On("perf_hooks").performance}catch{}return function(){return(e||Date).now()}}();var sc=e=>{let t=wi(k$(e)),r=Ur(e),n=z(r),a=le(r),o=e.Bind1().Apply0().Functor0(),i=h=>C=>N=>{let y=o.map(Q=>$(h(Q._1),Q._2)),U=C(N);return Q=>y(U(Q))},c=X.traverse(n),_=Y(r),l=At(r),p=sd(l),m=Q$(l)(Aa((()=>{let h=Ur(e);return{ask:e.Applicative0().pure,Monad0:()=>h}})())),f=qa(l),D=V$(l),s=h=>{let C=h.matrix,N=y=>{if(y.tag==="Leaf")return y._1>=0&&y._1<C.length?z$(t)(C[y._1].pats)(g(C[y._1].act)):F("Impossible");if(y.tag==="Fail")return n.pure(_t("ELRaise",void 0));if(y.tag==="Choice")return a.apply(i(U$())(N(y._1)))(N(y._2));if(y.tag==="Conditional")return a.apply(i(O$())(g(y._1)))(c(U=>i(Ut(U._1))(N(U._2)))(y._2));if(y.tag==="JumpThru")return a.apply(i(K$())(g(y._1)))(c(U=>i(Ut(U._1))(N(U._2)))(y._2));u()};return _.bind(p(h))(N)},S=h=>C=>N=>{let y=U=>Q=>{let he=U,qt=Q,Ue=!0,te;for(;Ue;){let Ee=he,$e=qt;if($e.tag==="ELLet"){he=[...Ee,...$e._2],qt=$e._3;continue}Ue=!1,te=_t("ELLet",void 0,Ee,$e)}return te};return _.bind(g(C))(U=>_.bind(Wa(t)(h)(jt)(g(N)))(Q=>n.pure(y([])(_t("ELLet",void 0,[U],Q)))))},g=h=>{if(h.tag==="ExprConst")return n.pure(_t("ELConst",void 0,Wi("SCAtom",h._2)));if(h.tag==="ExprVar")return _.bind(m(h._2))(C=>n.pure(gn.foldr(N=>y=>_t("ELPrim",void 0,Pt("PField",N),[y]))(_t("ELVar",void 0,C._1))(C._2)));if(h.tag==="ExprGlobal"){let C=h._2;return _.bind(f(C))(N=>N.desc.tag==="Prim"?n.pure(_t("ELPrim",void 0,N.desc._1.prim,[])):N.desc.tag==="Constructor"?_.bind(D(N.desc._1.name))(y=>n.pure(_t("ELPrim",void 0,Pt("PMakeBlock",Mn("TConstr",y)),[]))):n.pure(_t("ELPrim",void 0,Pt("PGetGlobal",C._1,C._2),[])))}if(h.tag==="ExprTuple")return i(B$()(Pt("PMakeBlock",Oi)))(c(g)(h._2));if(h.tag==="ExprConstructor"){let C=h._3;return _.bind(D(h._2))(N=>_.bind(c(g)(C))(y=>n.pure(_t("ELPrim",void 0,Pt("PMakeBlock",Mn("TConstr",N)),y))))}if(h.tag==="ExprField"){let C=h._3;return _.bind(g(h._2))(N=>n.pure(_t("ELPrim",void 0,Pt("PField",C),[N])))}if(h.tag==="ExprFunc")return I()(h);if(h.tag==="ExprApp")return b()(h);if(h.tag==="ExprLet")return S(h._2.it)(h._3)(h._4);if(h.tag==="ExprIf")return a.apply(a.apply(i(J$())(g(h._2)))(g(h._3)))(g(h._4));if(h.tag==="ExprMatch")return s(h._2);if(h.tag==="ExprTyped")return g(h._2);u()},I=ra(()=>{let h=C=>N=>N.tag==="ExprFunc"?Wa(t)(Qa("arg",N._2.it))(jt)(h(C+1|0)(N._4)):_.bind(g(N))(y=>n.pure(_t("ELAbs",void 0,C,y)));return h(0)}),b=ra(()=>{let h=C=>N=>{if(N.tag==="ExprApp"){let y=N._2;return _.bind(g(N._3))(U=>h([U,...C])(y))}return _.bind(g(N))(y=>{if(y.tag==="ELPrim"&&y._2.tag==="PMakeBlock")return n.pure(_t("ELPrim",y._1,y._2,C));if(y.tag==="ELPrim"){if(y._2.tag==="P_i32_add"||y._2.tag==="P_i32_sub"||y._2.tag==="P_i32_mul"||y._2.tag==="P_i32_div"||y._2.tag==="P_i32_mod"||y._2.tag==="P_i32_equ"||y._2.tag==="P_i32_neq"||y._2.tag==="P_i32_le"||y._2.tag==="P_i32_lt")return n.pure(_t("ELPrim",y._1,y._2,C));if(y._2.tag==="P_log_and"||y._2.tag==="P_log_or"||y._2.tag==="P_log_not"||y._2.tag==="P_log_xor")return n.pure(_t("ELPrim",y._1,y._2,C))}return n.pure(_t("ELApp",void 0,y,C))})};return h([])}),T=I(),M=b();return g},pc=e=>{let t=e.Bind1().Apply0().Functor0(),r=sc(e);return n=>{if(n.tag==="NonRec"){let a=n._1.ident,o=r(n._1.expr);return i=>{let c=t.map(l=>$(W$("NonRec",{ident:a.it,term:l._1}),l._2)),_=o(i);return l=>c(_(l))}}if(n.tag==="Rec")return F("Not implemented: rec decl");u()}},ld=e=>{let t=Ur(e),r=z(t),n=X.traverse(r),a=pc(e);return o=>Y(t).bind(n(i=>a(i))(o.decls))(i=>r.pure({name:o.name,decls:i}))};var Qr=(e,t,r)=>({tag:"Binder",_1:e,_2:t,_3:r}),Vr=(e,t,r,n)=>({tag:e,_1:t,_2:r,_3:n}),Ir=(e,t,r,n,a,o)=>({tag:e,_1:t,_2:r,_3:n,_4:a,_5:o}),K=(e,t,r,n,a)=>({tag:e,_1:t,_2:r,_3:n,_4:a}),Et=e=>e,Nt=(e,t,r,n,a)=>({tag:e,_1:t,_2:r,_3:n,_4:a}),fd=e=>e,B=(e,t,r)=>({tag:e,_1:t,_2:r}),zr=(e,t,r,n)=>({tag:e,_1:t,_2:r,_3:n});var md=fd("Rec"),Yr=fd("NonRec");var Kn=Et("KW_if"),Jn=Et("KW_then"),Un=Et("KW_else"),Tr=Et("KW_let"),Zr=Et("KW_rec"),jn=Et("KW_and"),Qn=Et("KW_in"),Vn=Et("KW_fn"),zn=Et("KW_match"),Yn=Et("KW_with"),Zn=Et("KW_matchfn"),Hr=Et("KW_def"),Va=Et("KW_type"),Hn=Et("KW_alias"),Xr=Et("KW_as"),vr=Et("KW_of"),nr=B("TokLeftParens"),ar=B("TokRightParens"),gd=B("TokLeftBrace"),Dd=B("TokRightBrace"),Xn=B("TokLeftSquare"),tn=B("TokRightSquare");var or=B("TokComma"),Gr=B("TokEqual"),en=B("TokColon"),Ke=B("TokSemicolon"),vn=B("TokUnderscore"),yr=B("TokPipe"),Ae=B("TokRightArrow");var hd=B("TokUnit");var Sd=B("TokEOF");var Id=e=>t=>r=>Qr(e,t,r);var za=e=>t=>K("ExprList",e,t),Ya=e=>t=>K("ExprTuple",e,t),Za=e=>t=>r=>K("ExprApp",e,t,r),Ha=e=>t=>r=>K("ExprOperator",e,t,r),Xa=e=>t=>r=>K("ExprFunc",e,t,r),va=e=>t=>r=>n=>K("ExprLet",e,t,r,n),to=e=>t=>r=>n=>K("ExprIf",e,t,r,n),eo=e=>t=>r=>K("ExprMatch",e,t,r),ro=e=>t=>r=>K("ExprMatchFn",e,t,r);var no=e=>t=>K("ExprParensed",e,t),Td=e=>e;var Gd=e=>{if(e.tag==="TokLeftParens")return"(";if(e.tag==="TokRightParens")return")";if(e.tag==="TokLeftBrace")return"{";if(e.tag==="TokRightBrace")return"}";if(e.tag==="TokLeftSquare")return"[";if(e.tag==="TokRightSquare")return"]";if(e.tag==="TokDot")return".";if(e.tag==="TokComma")return",";if(e.tag==="TokEqual")return"=";if(e.tag==="TokColon")return":";if(e.tag==="TokSemicolon")return";";if(e.tag==="TokUnderscore")return"_";if(e.tag==="TokPipe")return"|";if(e.tag==="TokRightArrow")return"->";if(e.tag==="TokReserved"){if(e._1==="KW_if")return"if";if(e._1==="KW_then")return"then";if(e._1==="KW_else")return"else";if(e._1==="KW_let")return"let";if(e._1==="KW_rec")return"rec";if(e._1==="KW_and")return"and";if(e._1==="KW_in")return"in";if(e._1==="KW_fn")return"fn";if(e._1==="KW_match")return"match";if(e._1==="KW_with")return"with";if(e._1==="KW_matchfn")return"matchfn";if(e._1==="KW_def")return"def";if(e._1==="KW_type")return"type";if(e._1==="KW_alias")return"alias";if(e._1==="KW_as")return"as";if(e._1==="KW_of")return"of";u()}if(e.tag==="TokOperator"||e.tag==="TokIdent")return e._1;if(e.tag==="TokUnit")return"()";if(e.tag==="TokInt"||e.tag==="TokBool"||e.tag==="TokString")return e._1;if(e.tag==="TokEOF")return"<eof>";u()};var fc={eq:e=>t=>e==="KW_if"?t==="KW_if":e==="KW_then"?t==="KW_then":e==="KW_else"?t==="KW_else":e==="KW_let"?t==="KW_let":e==="KW_rec"?t==="KW_rec":e==="KW_and"?t==="KW_and":e==="KW_in"?t==="KW_in":e==="KW_fn"?t==="KW_fn":e==="KW_match"?t==="KW_match":e==="KW_with"?t==="KW_with":e==="KW_matchfn"?t==="KW_matchfn":e==="KW_def"?t==="KW_def":e==="KW_type"?t==="KW_type":e==="KW_alias"?t==="KW_alias":e==="KW_as"?t==="KW_as":e==="KW_of"&&t==="KW_of"},x={eq:e=>t=>e.tag==="TokLeftParens"?t.tag==="TokLeftParens":e.tag==="TokRightParens"?t.tag==="TokRightParens":e.tag==="TokLeftBrace"?t.tag==="TokLeftBrace":e.tag==="TokRightBrace"?t.tag==="TokRightBrace":e.tag==="TokLeftSquare"?t.tag==="TokLeftSquare":e.tag==="TokRightSquare"?t.tag==="TokRightSquare":e.tag==="TokDot"?t.tag==="TokDot":e.tag==="TokComma"?t.tag==="TokComma":e.tag==="TokEqual"?t.tag==="TokEqual":e.tag==="TokColon"?t.tag==="TokColon":e.tag==="TokSemicolon"?t.tag==="TokSemicolon":e.tag==="TokUnderscore"?t.tag==="TokUnderscore":e.tag==="TokPipe"?t.tag==="TokPipe":e.tag==="TokRightArrow"?t.tag==="TokRightArrow":e.tag==="TokReserved"?t.tag==="TokReserved"&&fc.eq(e._1)(t._1):e.tag==="TokOperator"?t.tag==="TokOperator"&&e._1===t._1:e.tag==="TokIdent"?t.tag==="TokIdent"&&e._1===t._1:e.tag==="TokUnit"?t.tag==="TokUnit":e.tag==="TokInt"?t.tag==="TokInt"&&e._1===t._1&&e._2===t._2:e.tag==="TokBool"?t.tag==="TokBool"&&e._1===t._1&&e._2===t._2:e.tag==="TokString"?t.tag==="TokString"&&e._1===t._1&&e._2===t._2:e.tag==="TokEOF"&&t.tag==="TokEOF"};var Rr=(e,t)=>({tag:e,_1:t}),Ot=(e,t,r)=>({tag:e,_1:t,_2:r});var yd=function(e){return function(t){return function(r){var n;r<11?n="[0-"+(r-1).toString()+"]":r===11?n="[0-9a]":n="[0-9a-"+String.fromCharCode(86+r)+"]";var a=new RegExp("^[\\+\\-]?"+n+"+$","i");return function(o){if(a.test(o)){var i=parseInt(o,r);return(i|0)===i?e(i):t}else return t}}}};var Dc=yd(dt)(G),Rd=Dc(10);var hc=typeof Array.from=="function",Sc=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",Ic=typeof String.prototype.fromCodePoint=="function",Tc=typeof String.prototype.codePointAt=="function",Ad=function(e){return Tc?function(t){return t.codePointAt(0)}:e};var bd=function(e){return Ic?String.fromCodePoint:e},wd=function(e){return function(t){return Sc?function(r){for(var n="",a=r[Symbol.iterator](),o=0;o<t;++o){var i=a.next();if(i.done)return n;n+=i.value}return n}:e(t)}},Ed=function(e){return function(t){return hc?function(r){return Array.from(r,t)}:e}};var Md=e=>{let t=pr(e);if(t===0)return G;if(t===1)return R("Just",{head:Ht(qe(0)(e)),tail:""});let r=Ht(qe(1)(e)),n=Ht(qe(0)(e));return 55296<=n&&n<=56319&&56320<=r&&r<=57343?R("Just",{head:(((n-55296|0)*1024|0)+(r-56320|0)|0)+65536|0,tail:ve(2)(e)}):R("Just",{head:n,tail:ve(1)(e)})},Gc=e=>{let t=Md(e);return t.tag==="Just"?R("Just",$(t._1.head,t._1.tail)):G},yc=e=>ye.unfoldr(Gc)(e),Rc=e=>{let t=Ht(qe(0)(e));if(55296<=t&&t<=56319&&pr(e)>1){let r=Ht(qe(1)(e));if(56320<=r&&r<=57343)return(((t-55296|0)*1024|0)+(r-56320|0)|0)+65536|0}return t},Cc=Ad(Rc),Ld=Ed(yc)(Cc);var oo=e=>In(e>=0&&e<=65535?ya(e):e<0?"\0":"\uFFFF"),Ac=e=>e<=65535?oo(e):oo(de(e-65536|0,1024)+55296|0)+oo(ee(e-65536|0)(1024)+56320|0);var bc=bd(Ac),Pd=e=>t=>{if(e<1)return"";let r=Md(t);return r.tag==="Just"?bc(r._1.head)+Pd(e-1|0)(r._1.tail):t},Nd=wd(Pd);var P=(e,t,r,n)=>({tag:e,_1:t,_2:r,_3:n});var Ec=e=>e==="fn"?R("Just",Vn):e==="if"?R("Just",Kn):e==="then"?R("Just",Jn):e==="else"?R("Just",Un):e==="let"?R("Just",Tr):e==="in"?R("Just",Qn):e==="rec"?R("Just",Zr):e==="and"?R("Just",jn):e==="match"?R("Just",zn):e==="matchfn"?R("Just",Zn):e==="with"?R("Just",Yn):e==="as"?R("Just",Xr):e==="of"?R("Just",vr):e==="def"?R("Just",Hr):e==="type"?R("Just",Va):e==="alias"?R("Just",Hn):G,Cr=e=>t=>e===""?{desc:Rr("LexUnexpected","<eof>"),pos:t}:Ld(e).length<=6?{desc:Rr("LexUnexpected",e),pos:t}:{desc:Rr("LexUnexpected",Nd(5)(e)+"..."),pos:t},io=e=>{let t=An("^(?:"+e+")")(Cn);return(r,n)=>{let a=Ni(t)(n);if(a.tag==="Just"){let o=(()=>{if(0<a._1.length)return a._1[0];u()})();if(o.tag==="Just"){let i=pr(o._1),c=Ei(Tn(i)(n)),_=c._2,p=(m=>f=>D=>{let s=m,S=f,g=D,I=!0,b;for(;I;){let T=s,M=S,h=g;if(h===0){I=!1,b=ne(T,M+_|0);continue}s=T+1|0,S=1,g=h-1|0}return b})(r._1)(r._2)(c._1);return P("LexSuccess",{it:o._1,at:{from:r,to:p}},ve(i)(n),p)}}return P("LexFail",Cr(n)(r),n)}},Mc=e=>{let t=r=>n=>{let a=r,o=n,i=!0,c;for(;i;){let _=a,l=o,p=e(l.pos,l.src);if(p.tag==="LexSuccess"){a=[..._,p._1],o={src:p._2,pos:p._3};continue}if(p.tag==="LexFail"){if(l.src===p._2){i=!1,c=P("LexSuccess",_,p._2,p._1.pos);continue}i=!1,c=P("LexFail",p._1,p._2);continue}u()}return c};return(r,n)=>t([])({pos:r,src:n})},Fd=(e,t)=>P("LexSuccess",{pos:e,src:t},t,e);var Lc=(e,t)=>t===""?P("LexSuccess",{it:Sd,at:{from:e,to:e}},t,e):P("LexFail",Cr("")(e),t),ta=e=>(t,r)=>{let n=Ca(r);if(n.tag==="Nothing")return P("LexFail",Cr("<eof>")(t),"");if(n.tag==="Just"){if(n._1.head===e){if(n._1.head===`
`){let c=(_=>l=>p=>{let m=_,f=l,D=p,s=!0,S;for(;s;){let g=m,I=f,b=D;if(b===0){s=!1,S=ne(g,I+0|0);continue}m=g+1|0,f=1,D=b-1|0}return S})(t._1)(t._2)(1);return P("LexSuccess",{it:e,at:{from:t,to:c}},n._1.tail,c)}let o=(i=>c=>_=>{let l=i,p=c,m=_,f=!0,D;for(;f;){let s=l,S=p,g=m;if(g===0){f=!1,D=ne(s,S+1|0);continue}l=s+1|0,p=1,m=g-1|0}return D})(t._1)(t._2)(0);return P("LexSuccess",{it:e,at:{from:t,to:o}},n._1.tail,o)}return P("LexFail",Cr(r)(t),r)}u()};var Pc=(()=>{let e=io("[a-zA-Z0-9_][a-zA-Z0-9'_]*");return(t,r)=>{let n=e(t,r);if(n.tag==="LexFail")return P("LexFail",n._1,n._2);if(n.tag==="LexSuccess"){let a=Ec(n._1.it);return a.tag==="Just"?P("LexSuccess",{...n._1,it:B("TokReserved",a._1)},n._2,n._3):n._1.it==="true"?P("LexSuccess",{...n._1,it:B("TokBool",n._1.it,!0)},n._2,n._3):n._1.it==="false"?P("LexSuccess",{...n._1,it:B("TokBool",n._1.it,!1)},n._2,n._3):n._1.it==="_"?P("LexSuccess",{...n._1,it:vn},n._2,n._3):P("LexSuccess",{...n._1,it:B("TokIdent",n._1.it)},n._2,n._3)}u()}})(),Nc=(()=>{let e=io("-?[0-9]+");return(t,r)=>{let n=e(t,r);if(n.tag==="LexFail")return P("LexFail",n._1,n._2);if(n.tag==="LexSuccess"){let a=Rd(n._1.it);if(a.tag==="Nothing")return F("Impossible")(n._3,n._2);if(a.tag==="Just")return P("LexSuccess",{...n._1,it:B("TokInt",n._1.it,a._1)},n._2,n._3)}u()}})();var Fc=(()=>{let e=io("[!#$%&=\\-\\^~|\\\\@+*:?/<>]+");return(t,r)=>{let n=e(t,r);if(n.tag==="LexFail")return P("LexFail",n._1,n._2);if(n.tag==="LexSuccess")return n._1.it==="="?P("LexSuccess",{...n._1,it:Gr},n._2,n._3):n._1.it===":"?P("LexSuccess",{...n._1,it:en},n._2,n._3):n._1.it==="->"?P("LexSuccess",{...n._1,it:Ae},n._2,n._3):n._1.it==="|"?P("LexSuccess",{...n._1,it:yr},n._2,n._3):P("LexSuccess",{...n._1,it:B("TokOperator",n._1.it)},n._2,n._3);u()}})(),xd=(e,t)=>{let r=Ca(t);if(r.tag==="Nothing")return P("LexFail",Cr(t)(e),t);if(r.tag==="Just"){if(r._1.head===`
`){let i=(c=>_=>l=>{let p=c,m=_,f=l,D=!0,s;for(;D;){let S=p,g=m,I=f;if(I===0){D=!1,s=ne(S,g+0|0);continue}p=S+1|0,m=1,f=I-1|0}return s})(e._1)(e._2)(1);return P("LexSuccess",{it:r._1.head,at:{from:e,to:i}},r._1.tail,i)}let a=(o=>i=>c=>{let _=o,l=i,p=c,m=!0,f;for(;m;){let D=_,s=l,S=p;if(S===0){m=!1,f=ne(D,s+1|0);continue}_=D+1|0,l=1,p=S-1|0}return f})(e._1)(e._2)(0);return P("LexSuccess",{it:r._1.head,at:{from:e,to:a}},r._1.tail,a)}u()},xc=(e,t)=>{let r=Fd(e,t);if(r.tag==="LexFail")return P("LexFail",r._1,r._2);if(r.tag==="LexSuccess"){let n=xd(r._3,r._2);if(n.tag==="LexFail")return P("LexFail",n._1,n._2);if(n.tag==="LexSuccess"){if(n._1.it===")")return P("LexSuccess",{...n._1,it:ar},n._2,n._3);if(n._1.it==="{")return P("LexSuccess",{...n._1,it:gd},n._2,n._3);if(n._1.it==="}")return P("LexSuccess",{...n._1,it:Dd},n._2,n._3);if(n._1.it==="[")return P("LexSuccess",{...n._1,it:Xn},n._2,n._3);if(n._1.it==="]")return P("LexSuccess",{...n._1,it:tn},n._2,n._3);if(n._1.it===",")return P("LexSuccess",{...n._1,it:or},n._2,n._3);if(n._1.it===";")return P("LexSuccess",{...n._1,it:Ke},n._2,n._3);if(n._1.it==="("){let a=Fd(n._3,n._2);if(a.tag==="LexFail")return P("LexFail",a._1,a._2);if(a.tag==="LexSuccess"){let o=xd(a._3,a._2);if(o.tag==="LexFail")return P("LexFail",o._1,o._2);if(o.tag==="LexSuccess")return o._1.it===")"?P("LexSuccess",{it:hd,at:{from:n._1.at.from,to:o._1.at.to}},o._2,o._3):P("LexSuccess",{...n._1,it:nr},a._1.src,a._1.pos)}u()}return P("LexFail",Cr(In(n._1.it))(n._1.at.from),r._1.src)}}u()};var qc=(()=>{let e=Mc((t,r)=>{let n=ta(`
`)(t,r);if(n.tag==="LexSuccess")return P("LexSuccess",n._1,n._2,n._3);if(n.tag==="LexFail"){if(n._2!==r)return P("LexFail",n._1,n._2);let a=ta("\r")(t,r);if(a.tag==="LexSuccess")return P("LexSuccess",a._1,a._2,a._3);if(a.tag==="LexFail"){if(a._2!==r)return P("LexFail",a._1,a._2);let o=ta(" ")(t,r);if(o.tag==="LexSuccess")return P("LexSuccess",o._1,o._2,o._3);if(o.tag==="LexFail")return o._2!==r?P("LexFail",o._1,o._2):ta("	")(t,r)}}u()});return(t,r)=>{let n=e(t,r);if(n.tag==="LexSuccess")return P("LexSuccess",n._1.length,n._2,n._3);if(n.tag==="LexFail")return P("LexFail",n._1,n._2);u()}})(),qd=(e,t)=>{let r=qc(e,t);if(r.tag==="LexFail")return P("LexFail",r._1,r._2);if(r.tag==="LexSuccess"){let n=xc(r._3,r._2);if(n.tag==="LexSuccess")return P("LexSuccess",n._1,n._2,n._3);if(n.tag==="LexFail"){if(n._2!==r._2)return P("LexFail",n._1,n._2);let a=Nc(r._3,r._2);if(a.tag==="LexSuccess")return P("LexSuccess",a._1,a._2,a._3);if(a.tag==="LexFail"){if(a._2!==r._2)return P("LexFail",a._1,a._2);let o=Pc(r._3,r._2);if(o.tag==="LexSuccess")return P("LexSuccess",o._1,o._2,o._3);if(o.tag==="LexFail"){if(o._2!==r._2)return P("LexFail",o._1,o._2);let i=Fc(r._3,r._2);if(i.tag==="LexSuccess")return P("LexSuccess",i._1,i._2,i._3);if(i.tag==="LexFail")return i._2!==r._2?P("LexFail",i._1,i._2):Lc(r._3,r._2)}}}}u()};var w=e=>t=>{let r=qd(t.pos,t.src);if(r.tag==="LexFail")return $(d("Left",{at:{from:r._1.pos,to:r._1.pos},desc:r._1.desc,toks:[]}),{src:r._2,pos:r._1.pos});if(r.tag==="LexSuccess")return e(r._1.it)?$(d("Right",r._1),{src:r._2,pos:r._3}):$(d("Left",{at:{from:r._1.at.from,to:r._1.at.to},desc:Rr("UnexpectedToken",r._1.it),toks:[r._1]}),t);u()};var kd=e=>w(t=>x.eq(t)(e));var Wc=e=>{let t=w(r=>x.eq(r)(vn))(e);return $((()=>{if(t._1.tag==="Left")return d("Left",t._1._1);if(t._1.tag==="Right")return d("Right",Nt("PatWildcard",{loc:t._1._1.at}));u()})(),t._2)},Bc=e=>{let t=w(r=>r.tag==="TokUnit")(e);return $((()=>{if(t._1.tag==="Left")return d("Left",t._1._1);if(t._1.tag==="Right")return d("Right",{...t._1._1,it:Ki});u()})(),t._2)},De=e=>t=>{let r=e(t);if(r._1.tag==="Right")return $(d("Right",R("Just",r._1._1)),r._2);if(r._1.tag==="Left"&&r._1._1.desc.tag==="UnexpectedToken")return $(d("Right",G),r._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);u()},Ud=e=>{let t=w(r=>r.tag==="TokOperator")(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right")return t._1._1.it.tag==="TokOperator"?$(d("Right",{it:t._1._1.it._1,at:t._1._1.at}),t._2):F("Impossible")(t._2);u()};var xt=e=>{let t=r=>n=>{let a=r,o=n,i=!0,c;for(;i;){let _=a,p=e(o);if(p._1.tag==="Right"){a=[..._,p._1._1],o=p._2;continue}if(p._1.tag==="Left"&&p._1._1.desc.tag==="UnexpectedToken"){i=!1,c=$(d("Right",_),p._2);continue}if(p._1.tag==="Left"){i=!1,c=$(d("Left",p._1._1),p._2);continue}u()}return c};return r=>t([])(r)};var jd=(()=>{let e=w(t=>t.tag==="TokInt");return t=>{let r=e(t);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right")return $(d("Right",r._1._1.it.tag==="TokInt"?{it:r._1._1.it._2,at:r._1._1.at}:F("Impossible")),r._2);u()}})(),Oc=e=>{let t=jd(e);return $((()=>{if(t._1.tag==="Left")return d("Left",t._1._1);if(t._1.tag==="Right")return d("Right",{...t._1._1,it:Or("ACInt",t._1._1.it)});u()})(),t._2)};var be=e=>{let t=w(r=>r.tag==="TokIdent")(e);return $((()=>{if(t._1.tag==="Left")return d("Left",t._1._1);if(t._1.tag==="Right")return d("Right",{...t._1._1,it:t._1._1.it.tag==="TokIdent"?t._1._1.it._1:F("Impossible")});u()})(),t._2)},Kc=e=>{let t=be(e);return $((()=>{if(t._1.tag==="Left")return d("Left",t._1._1);if(t._1.tag==="Right")return d("Right",K("ExprIdent",{loc:t._1._1.at},G,t._1._1.it));u()})(),t._2)},Jc=e=>{let t=be(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right")return $(d("Right",zr("TIdent",{loc:t._1._1.at},G,t._1._1.it)),t._2);u()},Wd=e=>{let t=Jc(e);if(t._1.tag==="Right")return $(d("Right",t._1._1),t._2);if(t._1.tag==="Left")return t._2.pos._1===e.pos._1&&t._2.pos._2===e.pos._2&&t._2.src===e.src?Uc(t._2):$(d("Left",t._1._1),t._2);u()},Bd=e=>{let t=Wd(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=xt(n=>{let a=w(o=>o.tag==="TokOperator"&&o._1==="*")(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right"){let o=Wd(a._2);return $((()=>{if(o._1.tag==="Left")return d("Left",o._1._1);if(o._1.tag==="Right")return d("Right",o._1._1);u()})(),o._2)}u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right")return r._1._1.length===0?$(d("Right",t._1._1),r._2):$(d("Right",zr("TTup",{loc:(()=>{let n=r._1._1[r._1._1.length-1|0];return{from:(()=>{if(t._1._1.tag==="TFunc"||t._1._1.tag==="TIdent"||t._1._1.tag==="TTup"||t._1._1.tag==="TParens")return t._1._1._1.loc.from;u()})(),to:(()=>{if(n.tag==="TFunc"||n.tag==="TIdent"||n.tag==="TTup"||n.tag==="TParens")return n._1.loc.to;u()})()}})()},[t._1._1,...r._1._1])),r._2)}u()},nn=e=>{let t=Bd(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=xt(n=>{let a=w(o=>x.eq(o)(Ae))(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right"){let o=Bd(a._2);return $((()=>{if(o._1.tag==="Left")return d("Left",o._1._1);if(o._1.tag==="Right")return d("Right",o._1._1);u()})(),o._2)}u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){if(r._1._1.length>0){let n=fn(r._1._1),a=(()=>{if(n.tag==="Just")return n._1;u()})();return $(d("Right",zr("TFunc",{loc:{from:(()=>{if(t._1._1.tag==="TFunc"||t._1._1.tag==="TIdent"||t._1._1.tag==="TTup"||t._1._1.tag==="TParens")return t._1._1._1.loc.from;u()})(),to:(()=>{if(a.last.tag==="TFunc"||a.last.tag==="TIdent"||a.last.tag==="TTup"||a.last.tag==="TParens")return a.last._1.loc.to;u()})()}},[t._1._1,...a.init],a.last)),r._2)}return $(d("Right",t._1._1),r._2)}}u()},Uc=e=>{let t=w(r=>x.eq(r)(nr))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=nn(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=w(a=>x.eq(a)(ar))(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right")return $(d("Right",zr("TParens",{loc:{from:t._1._1.at.from,to:n._1._1.at.to}},r._1._1)),n._2)}}u()};var jc=e=>{let t=w(r=>r.tag==="TokBool"&&r._2)(e);if(t._1.tag==="Left"){if(t._2.pos._1===e.pos._1&&t._2.pos._2===e.pos._2&&t._2.src===e.src){let r=w(n=>n.tag==="TokBool"&&!n._2)(t._2);return $((()=>{if(r._1.tag==="Left")return d("Left",r._1._1);if(r._1.tag==="Right")return d("Right",{it:Or("ACBool",!1),at:r._1._1.at});u()})(),r._2)}return $(d("Left",t._1._1),t._2)}if(t._1.tag==="Right")return $(d("Right",{it:Or("ACBool",!0),at:t._1._1.at}),t._2);u()},Qd=e=>{let t=jc(e);if(t._1.tag==="Right")return $(d("Right",t._1._1),t._2);if(t._1.tag==="Left"){if(t._2.pos._1===e.pos._1&&t._2.pos._2===e.pos._2&&t._2.src===e.src){let r=Oc(t._2);if(r._1.tag==="Right")return $(d("Right",r._1._1),r._2);if(r._1.tag==="Left")return r._2.pos._1===t._2.pos._1&&r._2.pos._2===t._2.pos._2&&r._2.src===t._2.src?Bc(r._2):$(d("Left",r._1._1),r._2);u()}return $(d("Left",t._1._1),t._2)}u()},Qc=e=>{let t=Qd(e);return $((()=>{if(t._1.tag==="Left")return d("Left",t._1._1);if(t._1.tag==="Right")return d("Right",K("ExprConst",{loc:t._1._1.at},t._1._1.it));u()})(),t._2)},Vc=e=>{let t=Qd(e);return $((()=>{if(t._1.tag==="Left")return d("Left",t._1._1);if(t._1.tag==="Right")return d("Right",Nt("PatConst",{loc:t._1._1.at},t._1._1.it));u()})(),t._2)};var zc=e=>{let t=w(n=>x.eq(n)(B("TokReserved",Hr)))(e),r=(()=>{if(t._1.tag==="Left")return $(d("Left",t._1._1),e);if(t._1.tag==="Right"){let n=w(a=>a.tag==="TokIdent"&&a._1==="set")(t._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),e);if(n._1.tag==="Right")return $(d("Right",$(t._1._1,n._1._1)),n._2)}u()})();if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=r._1._1._1.at,a=be(r._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right"){let o=w(i=>x.eq(i)(Gr))(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),o._2);if(o._1.tag==="Right"){let i=De(c=>{let _=be(c);if(_._1.tag==="Left")return $(d("Left",_._1._1),_._2);if(_._1.tag==="Right"){let l=De(p=>{let m=w(f=>x.eq(f)(B("TokReserved",vr)))(p);if(m._1.tag==="Left")return $(d("Left",m._1._1),p);if(m._1.tag==="Right"){let f=nn(m._2);if(f._1.tag==="Left")return $(d("Left",f._1._1),p);if(f._1.tag==="Right")return $(d("Right",$(m._1._1,f._1._1)),f._2)}u()})(_._2);if(l._1.tag==="Left")return $(d("Left",l._1._1),l._2);if(l._1.tag==="Right"){if(l._1._1.tag==="Nothing")return $(d("Right",Vr("ConstrNull",{loc:_._1._1.at},_._1._1)),l._2);if(l._1._1.tag==="Just")return $(d("Right",Vr("ConstrStructured",{loc:{from:_._1._1.at.from,to:(()=>{if(l._1._1._1._2.tag==="TFunc"||l._1._1._1._2.tag==="TIdent"||l._1._1._1._2.tag==="TTup"||l._1._1._1._2.tag==="TParens")return l._1._1._1._2._1.loc.to;u()})()}},_._1._1,l._1._1._1._2)),l._2)}}u()})(o._2);if(i._1.tag==="Left")return $(d("Left",i._1._1),i._2);if(i._1.tag==="Right"){let c=xt(_=>{let l=w(p=>x.eq(p)(yr))(_);if(l._1.tag==="Left")return $(d("Left",l._1._1),_);if(l._1.tag==="Right"){let p=be(l._2);if(p._1.tag==="Left")return $(d("Left",p._1._1),_);if(p._1.tag==="Right"){let m=De(f=>{let D=w(s=>x.eq(s)(B("TokReserved",vr)))(f);if(D._1.tag==="Left")return $(d("Left",D._1._1),f);if(D._1.tag==="Right"){let s=nn(D._2);if(s._1.tag==="Left")return $(d("Left",s._1._1),f);if(s._1.tag==="Right")return $(d("Right",$(D._1._1,s._1._1)),s._2)}u()})(p._2);if(m._1.tag==="Left")return $(d("Left",m._1._1),_);if(m._1.tag==="Right"){if(m._1._1.tag==="Nothing")return $(d("Right",Vr("ConstrNull",{loc:p._1._1.at},p._1._1)),m._2);if(m._1._1.tag==="Just")return $(d("Right",Vr("ConstrStructured",{loc:{from:p._1._1.at.from,to:(()=>{if(m._1._1._1._2.tag==="TFunc"||m._1._1._1._2.tag==="TIdent"||m._1._1._1._2.tag==="TTup"||m._1._1._1._2.tag==="TParens")return m._1._1._1._2._1.loc.to;u()})()}},p._1._1,m._1._1._1._2)),m._2)}}}u()})(i._2);if(c._1.tag==="Left")return $(d("Left",c._1._1),c._2);if(c._1.tag==="Right"){let _=(()=>{if(i._1._1.tag==="Nothing")return c._1._1;if(i._1._1.tag==="Just")return[i._1._1._1,...c._1._1];u()})(),l=Te(_);if(l.tag==="Nothing")return $(d("Right",Ir("DeclSet",{loc:{from:n.from,to:o._1._1.at.to}},a._1._1,_)),c._2);if(l.tag==="Just")return $(d("Right",Ir("DeclSet",{loc:{from:n.from,to:(()=>{if(l._1.tag==="ConstrStructured"||l._1.tag==="ConstrNull")return l._1._1.loc.to;u()})()}},a._1._1,_)),c._2)}}}}}u()};var $o=e=>{let t=Wc(e);if(t._1.tag==="Right")return $(d("Right",t._1._1),t._2);if(t._1.tag==="Left"){if(t._2.pos._1===e.pos._1&&t._2.pos._2===e.pos._2&&t._2.src===e.src){let r=Hc(t._2);if(r._1.tag==="Right")return $(d("Right",r._1._1),r._2);if(r._1.tag==="Left"){if(r._2.pos._1===t._2.pos._1&&r._2.pos._2===t._2.pos._2&&r._2.src===t._2.src){let n=Vc(r._2);if(n._1.tag==="Right")return $(d("Right",n._1._1),n._2);if(n._1.tag==="Left")return n._2.pos._1===r._2.pos._1&&n._2.pos._2===r._2.pos._2&&n._2.src===r._2.src?Xc(n._2):$(d("Left",n._1._1),n._2);u()}return $(d("Left",r._1._1),r._2)}u()}return $(d("Left",t._1._1),t._2)}u()},Yc=e=>{let t=$o(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=xt(n=>{let a=w(o=>x.eq(o)(or))(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),n);if(a._1.tag==="Right"){let o=$o(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),n);if(o._1.tag==="Right")return $(d("Right",o._1._1),o._2)}u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=Te(r._1._1);if(n.tag==="Nothing")return $(d("Right",t._1._1),r._2);if(n.tag==="Just")return $(d("Right",Nt("PatTuple",{loc:{from:(()=>{if(t._1._1.tag==="PatWildcard"||t._1._1.tag==="PatVar"||t._1._1.tag==="PatConst"||t._1._1.tag==="PatTuple"||t._1._1.tag==="PatList"||t._1._1.tag==="PatConstructor"||t._1._1.tag==="PatAlias"||t._1._1.tag==="PatParensed"||t._1._1.tag==="PatTyped")return t._1._1._1.loc.from;u()})(),to:(()=>{if(n._1.tag==="PatWildcard"||n._1.tag==="PatVar"||n._1.tag==="PatConst"||n._1.tag==="PatTuple"||n._1.tag==="PatList"||n._1.tag==="PatConstructor"||n._1.tag==="PatAlias"||n._1.tag==="PatParensed"||n._1.tag==="PatTyped")return n._1._1.loc.to;u()})()}},[t._1._1,...r._1._1])),r._2)}}u()},Zc=e=>{let t=Yc(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=De(n=>{let a=w(o=>x.eq(o)(en))(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),n);if(a._1.tag==="Right"){let o=nn(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),n);if(o._1.tag==="Right")return $(d("Right",o._1._1),o._2)}u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){if(r._1._1.tag==="Nothing")return $(d("Right",t._1._1),r._2);if(r._1._1.tag==="Just")return $(d("Right",Nt("PatTyped",{loc:{from:(()=>{if(t._1._1.tag==="PatWildcard"||t._1._1.tag==="PatVar"||t._1._1.tag==="PatConst"||t._1._1.tag==="PatTuple"||t._1._1.tag==="PatList"||t._1._1.tag==="PatConstructor"||t._1._1.tag==="PatAlias"||t._1._1.tag==="PatParensed"||t._1._1.tag==="PatTyped")return t._1._1._1.loc.from;u()})(),to:(()=>{if(r._1._1._1.tag==="TFunc"||r._1._1._1.tag==="TIdent"||r._1._1._1.tag==="TTup"||r._1._1._1.tag==="TParens")return r._1._1._1._1.loc.to;u()})()}},t._1._1,r._1._1._1)),r._2)}}u()},we=e=>{let t=Zc(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=De(n=>{let a=w(o=>x.eq(o)(B("TokReserved",Xr)))(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right")return be(a._2);u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){if(r._1._1.tag==="Nothing")return $(d("Right",t._1._1),r._2);if(r._1._1.tag==="Just")return $(d("Right",Nt("PatAlias",{loc:{from:(()=>{if(t._1._1.tag==="PatWildcard"||t._1._1.tag==="PatVar"||t._1._1.tag==="PatConst"||t._1._1.tag==="PatTuple"||t._1._1.tag==="PatList"||t._1._1.tag==="PatConstructor"||t._1._1.tag==="PatAlias"||t._1._1.tag==="PatParensed"||t._1._1.tag==="PatTyped")return t._1._1._1.loc.from;u()})(),to:r._1._1._1.at.to}},t._1._1,r._1._1._1.it)),r._2)}}u()},Hc=e=>{let t=be(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=De($o)(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right")return ae(fe)(t._1._1.it)?$(d("Right",Nt("PatConstructor",(()=>{if(r._1._1.tag==="Nothing")return{loc:t._1._1.at};if(r._1._1.tag==="Just")return{loc:{from:t._1._1.at.from,to:(()=>{if(r._1._1._1.tag==="PatWildcard"||r._1._1._1.tag==="PatVar"||r._1._1._1.tag==="PatConst"||r._1._1._1.tag==="PatTuple"||r._1._1._1.tag==="PatList"||r._1._1._1.tag==="PatConstructor"||r._1._1._1.tag==="PatAlias"||r._1._1._1.tag==="PatParensed"||r._1._1._1.tag==="PatTyped")return r._1._1._1._1.loc.to;u()})()}};u()})(),G,t._1._1.it,r._1._1)),r._2):$(d("Right",Nt("PatVar",{loc:t._1._1.at},t._1._1.it)),r._2)}u()},Xc=e=>{let t=w(r=>x.eq(r)(nr))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=we(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=w(a=>x.eq(a)(ar))(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right")return $(d("Right",Nt("PatParensed",{loc:{from:t._1._1.at.from,to:n._1._1.at.to}},r._1._1)),n._2)}}u()},vc=e=>{let t=w(r=>x.eq(r)(nr))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=Ft(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=w(a=>x.eq(a)(ar))(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right")return $(d("Right",K("ExprParensed",{loc:{from:t._1._1.at.from,to:n._1._1.at.to}},r._1._1)),n._2)}}u()},_o=e=>{let t=w(n=>x.eq(n)(yr))(e),r=(()=>{if(t._1.tag==="Left")return $(d("Left",t._1._1),e);if(t._1.tag==="Right"){let n=we(t._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),e);if(n._1.tag==="Right"){if(n._1._1.tag==="PatTuple"){let o=w(i=>x.eq(i)(Ae))(n._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),e);if(o._1.tag==="Right"){let i=Ft(o._2);if(i._1.tag==="Left")return $(d("Left",i._1._1),e);if(i._1.tag==="Right")return $(d("Right",{pats:n._1._1._2,act:i._1._1}),i._2)}u()}let a=w(o=>x.eq(o)(Ae))(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),e);if(a._1.tag==="Right"){let o=Ft(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),e);if(o._1.tag==="Right")return $(d("Right",{pats:[n._1._1],act:o._1._1}),o._2)}}}u()})();if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=xt(a=>{let o=w(i=>x.eq(i)(yr))(a);if(o._1.tag==="Left")return $(d("Left",o._1._1),a);if(o._1.tag==="Right"){let i=we(o._2);if(i._1.tag==="Left")return $(d("Left",i._1._1),a);if(i._1.tag==="Right"){if(i._1._1.tag==="PatTuple"){let _=w(l=>x.eq(l)(Ae))(i._2);if(_._1.tag==="Left")return $(d("Left",_._1._1),a);if(_._1.tag==="Right"){let l=Ft(_._2);if(l._1.tag==="Left")return $(d("Left",l._1._1),a);if(l._1.tag==="Right")return $(d("Right",{pats:i._1._1._2,act:l._1._1}),l._2)}u()}let c=w(_=>x.eq(_)(Ae))(i._2);if(c._1.tag==="Left")return $(d("Left",c._1._1),a);if(c._1.tag==="Right"){let _=Ft(c._2);if(_._1.tag==="Left")return $(d("Left",_._1._1),a);if(_._1.tag==="Right")return $(d("Right",{pats:[i._1._1],act:_._1._1}),_._2)}}}u()})(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right")return $(d("Right",[r._1._1,...n._1._1]),n._2)}u()},ts=e=>{let t=w(r=>x.eq(r)(B("TokReserved",Zn)))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=we(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=xt(we)(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right"){if(n._1._1.length===0){let o=_o(n._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),o._2);if(o._1.tag==="Right")return $(d("Right",K("ExprMatchFn",{loc:{from:t._1._1.at.from,to:t._1._1.at.to}},[r._1._1],o._1._1)),o._2);u()}let a=_o(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right")return $(d("Right",K("ExprMatchFn",{loc:{from:t._1._1.at.from,to:t._1._1.at.to}},[r._1._1,...n._1._1],a._1._1)),a._2)}}}u()},es=e=>{let t=w(r=>x.eq(r)(B("TokReserved",zn)))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),e);if(t._1.tag==="Right"){let r=uo(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),e);if(r._1.tag==="Right"){let n=xt(a=>{let o=w(i=>x.eq(i)(or))(a);if(o._1.tag==="Left")return $(d("Left",o._1._1),a);if(o._1.tag==="Right"){let i=uo(o._2);if(i._1.tag==="Left")return $(d("Left",i._1._1),a);if(i._1.tag==="Right")return $(d("Right",i._1._1),i._2)}u()})(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),e);if(n._1.tag==="Right"){let a=w(o=>x.eq(o)(B("TokReserved",Yn)))(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),e);if(a._1.tag==="Right"){let o=_o(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),e);if(o._1.tag==="Right")return $(d("Right",K("ExprMatch",{loc:{from:t._1._1.at.from,to:t._1._1.at.to}},[r._1._1,...n._1._1],o._1._1)),o._2)}}}}u()},rs=e=>{let t=w(r=>x.eq(r)(Xn))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=xt(n=>{let a=Ft(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),n);if(a._1.tag==="Right"){let o=w(i=>x.eq(i)(Ke))(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),n);if(o._1.tag==="Right")return $(d("Right",a._1._1),o._2)}u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=De(Ft)(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right"){if(n._1._1.tag==="Nothing"){let a=w(o=>x.eq(o)(tn))(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right")return $(d("Right",K("ExprList",{loc:{from:t._1._1.at.from,to:a._1._1.at.to}},r._1._1)),a._2);u()}if(n._1._1.tag==="Just"){let a=w(o=>x.eq(o)(tn))(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right")return $(d("Right",K("ExprList",{loc:{from:t._1._1.at.from,to:a._1._1.at.to}},v(r._1._1)(n._1._1._1))),a._2)}}}}u()},ns=e=>{let t=w(r=>x.eq(r)(B("TokReserved",Tr)))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=De(kd(B("TokReserved",Zr)))(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=_s(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),r._2);if(n._1.tag==="Right"){let a=De(kd(Ke))(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),r._2);if(a._1.tag==="Right"){let o=w(i=>x.eq(i)(B("TokReserved",Qn)))(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),r._2);if(o._1.tag==="Right"){let i=Ft(o._2);if(i._1.tag==="Left")return $(d("Left",i._1._1),r._2);if(i._1.tag==="Right")return $(d("Right",K("ExprLet",{loc:t._1._1.at},(()=>{if(r._1._1.tag==="Nothing")return Yr;if(r._1._1.tag==="Just")return md;u()})(),n._1._1.it,i._1._1)),i._2)}}}}}u()},as=e=>{let t=w(r=>x.eq(r)(B("TokReserved",Kn)))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=Ft(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=w(a=>x.eq(a)(B("TokReserved",Jn)))(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right"){let a=Ft(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right"){let o=w(i=>x.eq(i)(B("TokReserved",Un)))(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),o._2);if(o._1.tag==="Right"){let i=Ft(o._2);if(i._1.tag==="Left")return $(d("Left",i._1._1),i._2);if(i._1.tag==="Right")return $(d("Right",K("ExprIf",{loc:{from:t._1._1.at.from,to:o._1._1.at.to}},r._1._1,a._1._1,i._1._1)),i._2)}}}}}u()},os=e=>{let t=w(r=>x.eq(r)(B("TokReserved",Vn)))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=we(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=xt(we)(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right"){let a=w(o=>x.eq(o)(Ae))(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right"){let o=Ft(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),o._2);if(o._1.tag==="Right")return $(d("Right",K("ExprFunc",{loc:{from:t._1._1.at.from,to:(()=>{if(o._1._1.tag==="ExprConst"||o._1._1.tag==="ExprList"||o._1._1.tag==="ExprTuple"||o._1._1.tag==="ExprIdent"||o._1._1.tag==="ExprFunc"||o._1._1.tag==="ExprApp"||o._1._1.tag==="ExprOperator"||o._1._1.tag==="ExprLet"||o._1._1.tag==="ExprIf"||o._1._1.tag==="ExprMatch"||o._1._1.tag==="ExprMatchFn"||o._1._1.tag==="ExprTyped"||o._1._1.tag==="ExprParensed")return o._1._1._1.loc.to;u()})()}},[r._1._1,...n._1._1],o._1._1)),o._2)}}}}u()},is=e=>{let t=Qc(e);if(t._1.tag==="Right")return $(d("Right",t._1._1),t._2);if(t._1.tag==="Left"){if(t._2.pos._1===e.pos._1&&t._2.pos._2===e.pos._2&&t._2.src===e.src){let r=Kc(t._2);if(r._1.tag==="Right")return $(d("Right",r._1._1),r._2);if(r._1.tag==="Left")return r._2.pos._1===t._2.pos._1&&r._2.pos._2===t._2.pos._2&&r._2.src===t._2.src?vc(r._2):$(d("Left",r._1._1),r._2);u()}return $(d("Left",t._1._1),t._2)}u()},uo=e=>{let t=rs(e);if(t._1.tag==="Right")return $(d("Right",t._1._1),t._2);if(t._1.tag==="Left")return t._2.pos._1===e.pos._1&&t._2.pos._2===e.pos._2&&t._2.src===e.src?is(t._2):$(d("Left",t._1._1),t._2);u()},Od=e=>{let t=os(e);if(t._1.tag==="Right")return $(d("Right",t._1._1),t._2);if(t._1.tag==="Left"){if(t._2.pos._1===e.pos._1&&t._2.pos._2===e.pos._2&&t._2.src===e.src){let r=as(t._2);if(r._1.tag==="Right")return $(d("Right",r._1._1),r._2);if(r._1.tag==="Left"){if(r._2.pos._1===t._2.pos._1&&r._2.pos._2===t._2.pos._2&&r._2.src===t._2.src){let n=ns(r._2);if(n._1.tag==="Right")return $(d("Right",n._1._1),n._2);if(n._1.tag==="Left"){if(n._2.pos._1===r._2.pos._1&&n._2.pos._2===r._2.pos._2&&n._2.src===r._2.src){let a=es(n._2);if(a._1.tag==="Right")return $(d("Right",a._1._1),a._2);if(a._1.tag==="Left"){if(a._2.pos._1===n._2.pos._1&&a._2.pos._2===n._2.pos._2&&a._2.src===n._2.src){let o=ts(a._2);if(o._1.tag==="Right")return $(d("Right",o._1._1),o._2);if(o._1.tag==="Left")return o._2.pos._1===a._2.pos._1&&o._2.pos._2===a._2.pos._2&&o._2.src===a._2.src?uo(o._2):$(d("Left",o._1._1),o._2);u()}return $(d("Left",a._1._1),a._2)}u()}return $(d("Left",n._1._1),n._2)}u()}return $(d("Left",r._1._1),r._2)}u()}return $(d("Left",t._1._1),t._2)}u()},$s=e=>{let t=Od(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=xt(Od)(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=fn(r._1._1);if(n.tag==="Nothing")return $(d("Right",t._1._1),r._2);if(n.tag==="Just")return $(d("Right",K("ExprApp",{loc:{from:(()=>{if(t._1._1.tag==="ExprConst"||t._1._1.tag==="ExprList"||t._1._1.tag==="ExprTuple"||t._1._1.tag==="ExprIdent"||t._1._1.tag==="ExprFunc"||t._1._1.tag==="ExprApp"||t._1._1.tag==="ExprOperator"||t._1._1.tag==="ExprLet"||t._1._1.tag==="ExprIf"||t._1._1.tag==="ExprMatch"||t._1._1.tag==="ExprMatchFn"||t._1._1.tag==="ExprTyped"||t._1._1.tag==="ExprParensed")return t._1._1._1.loc.from;u()})(),to:(()=>{if(n._1.last.tag==="ExprConst"||n._1.last.tag==="ExprList"||n._1.last.tag==="ExprTuple"||n._1.last.tag==="ExprIdent"||n._1.last.tag==="ExprFunc"||n._1.last.tag==="ExprApp"||n._1.last.tag==="ExprOperator"||n._1.last.tag==="ExprLet"||n._1.last.tag==="ExprIf"||n._1.last.tag==="ExprMatch"||n._1.last.tag==="ExprMatchFn"||n._1.last.tag==="ExprTyped"||n._1.last.tag==="ExprParensed")return n._1.last._1.loc.to;u()})()}},t._1._1,v(n._1.init)(n._1.last))),r._2)}}u()},Kd=e=>{let t=$s(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=xt(n=>{let a=Ud(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),n);if(a._1.tag==="Right"){let o=Ft(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),n);if(o._1.tag==="Right")return $(d("Right",{op:a._1._1,rhs:o._1._1}),o._2)}u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=fn(r._1._1);if(n.tag==="Nothing")return $(d("Right",t._1._1),r._2);if(n.tag==="Just")return $(d("Right",K("ExprOperator",{loc:{from:(()=>{if(t._1._1.tag==="ExprConst"||t._1._1.tag==="ExprList"||t._1._1.tag==="ExprTuple"||t._1._1.tag==="ExprIdent"||t._1._1.tag==="ExprFunc"||t._1._1.tag==="ExprApp"||t._1._1.tag==="ExprOperator"||t._1._1.tag==="ExprLet"||t._1._1.tag==="ExprIf"||t._1._1.tag==="ExprMatch"||t._1._1.tag==="ExprMatchFn"||t._1._1.tag==="ExprTyped"||t._1._1.tag==="ExprParensed")return t._1._1._1.loc.from;u()})(),to:(()=>{if(n._1.last.rhs.tag==="ExprConst"||n._1.last.rhs.tag==="ExprList"||n._1.last.rhs.tag==="ExprTuple"||n._1.last.rhs.tag==="ExprIdent"||n._1.last.rhs.tag==="ExprFunc"||n._1.last.rhs.tag==="ExprApp"||n._1.last.rhs.tag==="ExprOperator"||n._1.last.rhs.tag==="ExprLet"||n._1.last.rhs.tag==="ExprIf"||n._1.last.rhs.tag==="ExprMatch"||n._1.last.rhs.tag==="ExprMatchFn"||n._1.last.rhs.tag==="ExprTyped"||n._1.last.rhs.tag==="ExprParensed")return n._1.last.rhs._1.loc.to;u()})()}},t._1._1,v(n._1.init)(n._1.last))),r._2)}}u()},ds=e=>{let t=Kd(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=xt(n=>{let a=w(o=>x.eq(o)(or))(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),n);if(a._1.tag==="Right"){let o=Kd(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),n);if(o._1.tag==="Right")return $(d("Right",o._1._1),o._2)}u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=Te(r._1._1);if(n.tag==="Nothing")return $(d("Right",t._1._1),r._2);if(n.tag==="Just")return $(d("Right",K("ExprTuple",{loc:{from:(()=>{if(t._1._1.tag==="ExprConst"||t._1._1.tag==="ExprList"||t._1._1.tag==="ExprTuple"||t._1._1.tag==="ExprIdent"||t._1._1.tag==="ExprFunc"||t._1._1.tag==="ExprApp"||t._1._1.tag==="ExprOperator"||t._1._1.tag==="ExprLet"||t._1._1.tag==="ExprIf"||t._1._1.tag==="ExprMatch"||t._1._1.tag==="ExprMatchFn"||t._1._1.tag==="ExprTyped"||t._1._1.tag==="ExprParensed")return t._1._1._1.loc.from;u()})(),to:(()=>{if(n._1.tag==="ExprConst"||n._1.tag==="ExprList"||n._1.tag==="ExprTuple"||n._1.tag==="ExprIdent"||n._1.tag==="ExprFunc"||n._1.tag==="ExprApp"||n._1.tag==="ExprOperator"||n._1.tag==="ExprLet"||n._1.tag==="ExprIf"||n._1.tag==="ExprMatch"||n._1.tag==="ExprMatchFn"||n._1.tag==="ExprTyped"||n._1.tag==="ExprParensed")return n._1._1.loc.to;u()})()}},[t._1._1,...r._1._1])),r._2)}}u()},Ft=e=>{let t=ds(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=De(n=>{let a=w(o=>x.eq(o)(en))(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right")return nn(a._2);u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){if(r._1._1.tag==="Nothing")return $(d("Right",t._1._1),r._2);if(r._1._1.tag==="Just")return $(d("Right",K("ExprTyped",{loc:{from:(()=>{if(t._1._1.tag==="ExprConst"||t._1._1.tag==="ExprList"||t._1._1.tag==="ExprTuple"||t._1._1.tag==="ExprIdent"||t._1._1.tag==="ExprFunc"||t._1._1.tag==="ExprApp"||t._1._1.tag==="ExprOperator"||t._1._1.tag==="ExprLet"||t._1._1.tag==="ExprIf"||t._1._1.tag==="ExprMatch"||t._1._1.tag==="ExprMatchFn"||t._1._1.tag==="ExprTyped"||t._1._1.tag==="ExprParensed")return t._1._1._1.loc.from;u()})(),to:(()=>{if(r._1._1._1.tag==="TFunc"||r._1._1._1.tag==="TIdent"||r._1._1._1.tag==="TTup"||r._1._1._1.tag==="TParens")return r._1._1._1._1.loc.to;u()})()}},t._1._1,r._1._1._1)),r._2)}}u()},_s=e=>{let t=Jd(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=xt(n=>{let a=w(o=>x.eq(o)(Ke))(n);if(a._1.tag==="Left")return $(d("Left",a._1._1),n);if(a._1.tag==="Right"){let o=Jd(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),n);if(o._1.tag==="Right")return $(d("Right",o._1._1),o._2)}u()})(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=Te(r._1._1);if(n.tag==="Nothing")return $(d("Right",{it:[t._1._1],at:t._1._1._1.loc}),r._2);if(n.tag==="Just")return $(d("Right",{it:[t._1._1,...r._1._1],at:{from:t._1._1._1.loc.from,to:n._1._1.loc.to}}),r._2)}}u()},Jd=e=>{let t=we(e),r=(()=>{if(t._1.tag==="Left")return $(d("Left",t._1._1),e);if(t._1.tag==="Right"){let a=w(o=>x.eq(o)(Gr))(t._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),e);if(a._1.tag==="Right")return $(d("Right",$(t._1._1,a._1._1)),a._2)}u()})(),n=(()=>{if(r._1.tag==="Left")return $(d("Left",r._1._1),e);if(r._1.tag==="Right"){let a=Ft(r._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),e);if(a._1.tag==="Right")return $(d("Right",$(r._1._1,a._1._1)),a._2)}u()})();if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right")return $(d("Right",Qr({loc:{from:(()=>{if(n._1._1._1._1.tag==="PatWildcard"||n._1._1._1._1.tag==="PatVar"||n._1._1._1._1.tag==="PatConst"||n._1._1._1._1.tag==="PatTuple"||n._1._1._1._1.tag==="PatList"||n._1._1._1._1.tag==="PatConstructor"||n._1._1._1._1.tag==="PatAlias"||n._1._1._1._1.tag==="PatParensed"||n._1._1._1._1.tag==="PatTyped")return n._1._1._1._1._1.loc.from;u()})(),to:(()=>{if(n._1._1._2.tag==="ExprConst"||n._1._1._2.tag==="ExprList"||n._1._1._2.tag==="ExprTuple"||n._1._1._2.tag==="ExprIdent"||n._1._1._2.tag==="ExprFunc"||n._1._1._2.tag==="ExprApp"||n._1._1._2.tag==="ExprOperator"||n._1._1._2.tag==="ExprLet"||n._1._1._2.tag==="ExprIf"||n._1._1._2.tag==="ExprMatch"||n._1._1._2.tag==="ExprMatchFn"||n._1._1._2.tag==="ExprTyped"||n._1._1._2.tag==="ExprParensed")return n._1._1._2._1.loc.to;u()})()}},n._1._1._1._1,n._1._1._2)),n._2);u()},co=e=>{let t=xt(we),r=be(e);if(r._1.tag==="Left")return $(d("Left",r._1._1),e);if(r._1.tag==="Right"){let n=t(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),e);if(n._1.tag==="Right"){let a=w(o=>x.eq(o)(Gr))(n._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),e);if(a._1.tag==="Right"){let o=Ft(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),e);if(o._1.tag==="Right")return $(d("Right",{name:r._1._1,pats:n._1._1,exp:o._1._1}),o._2)}}}u()},us=e=>{let t=w(r=>x.eq(r)(B("TokReserved",Tr)))(e);if(t._1.tag==="Left")return $(d("Left",t._1._1),t._2);if(t._1.tag==="Right"){let r=co(t._2);if(r._1.tag==="Left")return $(d("Left",r._1._1),r._2);if(r._1.tag==="Right"){let n=w(a=>x.eq(a)(Ke))(r._2);if(n._1.tag==="Left")return $(d("Left",n._1._1),n._2);if(n._1.tag==="Right")return $(d("Right",Ir("Decl",{loc:{from:t._1._1.at.from,to:n._1._1.at.to}},r._1._1.name,r._1._1.pats,r._1._1.exp)),n._2)}}u()};var cs=e=>{let t=w(a=>x.eq(a)(B("TokReserved",Tr)))(e),r=(()=>{if(t._1.tag==="Left")return $(d("Left",t._1._1),e);if(t._1.tag==="Right"){let a=w(o=>x.eq(o)(B("TokReserved",Zr)))(t._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),e);if(a._1.tag==="Right")return $(d("Right",$(t._1._1,a._1._1)),a._2)}u()})(),n=(()=>{if(r._1.tag==="Left")return d("Left",r._1._1);if(r._1.tag==="Right")return d("Right",r._1._1._1);u()})();if(n.tag==="Left")return $(d("Left",n._1),r._2);if(n.tag==="Right"){let a=co(r._2);if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right"){let o=xt(i=>{let c=w(_=>x.eq(_)(B("TokReserved",jn)))(i);if(c._1.tag==="Left")return $(d("Left",c._1._1),i);if(c._1.tag==="Right"){let _=co(c._2);if(_._1.tag==="Left")return $(d("Left",_._1._1),i);if(_._1.tag==="Right")return $(d("Right",_._1._1),_._2)}u()})(a._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),o._2);if(o._1.tag==="Right"){let i=w(c=>x.eq(c)(Ke))(o._2);if(i._1.tag==="Left")return $(d("Left",i._1._1),i._2);if(i._1.tag==="Right")return $(d("Right",Ir("DeclRec",{loc:{from:n._1.at.from,to:i._1._1.at.to}},[a._1._1,...o._1._1])),i._2)}}}u()};var ss=e=>{let t=w(o=>x.eq(o)(B("TokReserved",Hr)))(e),r=(()=>{if(t._1.tag==="Left")return $(d("Left",t._1._1),e);if(t._1.tag==="Right"){let o=w(i=>x.eq(i)(B("TokReserved",Hn)))(t._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),e);if(o._1.tag==="Right"){let i=be(o._2);if(i._1.tag==="Left")return $(d("Left",i._1._1),e);if(i._1.tag==="Right")return $(d("Right",$($(t._1._1,o._1._1),i._1._1)),i._2)}}u()})(),n=(()=>{if(r._1.tag==="Left")return $(d("Left",r._1._1),e);if(r._1.tag==="Right"){let o=w(i=>x.eq(i)(B("TokReserved",Xr)))(r._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),e);if(o._1.tag==="Right")return $(d("Right",$(r._1._1,o._1._1)),o._2)}u()})(),a=(()=>{if(n._1.tag==="Left")return $(d("Left",n._1._1),e);if(n._1.tag==="Right"){let o=Ud(n._2);if(o._1.tag==="Left")return $(d("Left",o._1._1),e);if(o._1.tag==="Right")return $(d("Right",$(n._1._1,o._1._1)),o._2)}u()})();if(a._1.tag==="Left")return $(d("Left",a._1._1),a._2);if(a._1.tag==="Right"){let o=a._1._1._1._1._1._1.at,i=a._1._1._1._1._2,c=w(_=>x.eq(_)(nr))(a._2);if(c._1.tag==="Left")return $(d("Left",c._1._1),c._2);if(c._1.tag==="Right"){let _=w(p=>p.tag==="TokIdent"&&p._1==="assoc")(c._2),l=(()=>{if(_._1.tag==="Left")return $(d("Left",_._1._1),c._2);if(_._1.tag==="Right"){let p=w(f=>f.tag==="TokIdent"&&f._1==="left")(_._2),m=(()=>{if(p._1.tag==="Right")return $(d("Right",p._1._1),p._2);if(p._1.tag==="Left"){if(p._2.pos._1===_._2.pos._1&&p._2.pos._2===_._2.pos._2&&p._2.src===_._2.src){let f=w(D=>D.tag==="TokIdent"&&D._1==="right")(p._2);if(f._1.tag==="Right")return $(d("Right",f._1._1),f._2);if(f._1.tag==="Left")return f._2.pos._1===p._2.pos._1&&f._2.pos._2===p._2.pos._2&&f._2.src===p._2.src?w(D=>D.tag==="TokIdent"&&D._1==="none")(f._2):$(d("Left",f._1._1),f._2);u()}return $(d("Left",p._1._1),p._2)}u()})();if(m._1.tag==="Left")return $(d("Left",m._1._1),c._2);if(m._1.tag==="Right")return $(d("Right",$(_._1._1,m._1._1)),m._2)}u()})();if(l._1.tag==="Left")return $(d("Left",l._1._1),l._2);if(l._1.tag==="Right"){let p=w(m=>x.eq(m)(or))(l._2);if(p._1.tag==="Left")return $(d("Left",p._1._1),p._2);if(p._1.tag==="Right"){let m=jd(p._2);if(m._1.tag==="Left")return $(d("Left",m._1._1),m._2);if(m._1.tag==="Right"){let f=w(D=>x.eq(D)(ar))(m._2);if(f._1.tag==="Left")return $(d("Left",f._1._1),f._2);if(f._1.tag==="Right")return $(d("Right",Ir("DeclAlias",{loc:{from:o.from,to:f._1._1.at.to}},i,a._1._1._2,{...l._1._1._2,it:(()=>{if(l._1._1._2.it.tag==="TokIdent"){if(l._1._1._2.it._1==="left")return ie;if(l._1._1._2.it._1==="right")return Ji;if(l._1._1._2.it._1==="none")return Kr}return F("Impossible")})()},m._1._1)),f._2)}}}}}u()},ps=e=>{let t=cs(e);if(t._1.tag==="Right")return $(d("Right",t._1._1),t._2);if(t._1.tag==="Left"){if(t._2.pos._1===e.pos._1&&t._2.pos._2===e.pos._2&&t._2.src===e.src){let r=us(t._2);if(r._1.tag==="Right")return $(d("Right",r._1._1),r._2);if(r._1.tag==="Left"){if(r._2.pos._1===t._2.pos._1&&r._2.pos._2===t._2.pos._2&&r._2.src===t._2.src){let n=zc(r._2);if(n._1.tag==="Right")return $(d("Right",n._1._1),n._2);if(n._1.tag==="Left")return n._2.pos._1===r._2.pos._1&&n._2.pos._2===r._2.pos._2&&n._2.src===r._2.src?ss(n._2):$(d("Left",n._1._1),n._2);u()}return $(d("Left",r._1._1),r._2)}u()}return $(d("Left",t._1._1),t._2)}u()},Vd=e=>t=>{let r=a=>{let o=ps(a._2);if(o._1.tag==="Right")return pt("Loop",$(v(a._1)(o._1._1),o._2));if(o._1.tag==="Left"&&o._1._1.desc.tag==="UnexpectedToken"&&o._1._1.desc._1.tag==="TokEOF"&&o._1._1.toks.length===1&&o._1._1.toks[0].it.tag==="TokEOF")return pt("Done",d("Right",{loc:{from:ne(1,1),to:o._2.pos},name:e,decls:a._1}));if(o._1.tag==="Left")return pt("Done",d("Left",o._1._1));u()};return(a=>{let o=a,i=!0,c;for(;i;){let _=o;if(_.tag==="Loop"){o=r(_._1);continue}if(_.tag==="Done"){i=!1,c=_._1;continue}u()}return c})(r($([],{src:t,pos:ne(1,1)})))};var Z=e=>({bind:t=>r=>e.Bind1().bind(t)(n=>{if(n.tag==="Left")return e.Applicative0().pure(d("Left",n._1));if(n.tag==="Right")return r(n._1);u()}),Apply0:()=>zd(e)}),zd=e=>{let t=e.Bind1().Apply0().Functor0(),r={map:n=>t.map(a=>{if(a.tag==="Left")return d("Left",a._1);if(a.tag==="Right")return d("Right",n(a._1));u()})};return{apply:(()=>{let n=Z(e);return a=>o=>n.bind(a)(i=>n.bind(o)(c=>H(e).pure(i(c))))})(),Functor0:()=>r}},H=e=>({pure:t=>e.Applicative0().pure(d("Right",t)),Apply0:()=>zd(e)});var Yd=e=>{let t=e.Monad0(),r={Applicative0:()=>H(t),Bind1:()=>Z(t)};return{tailRecM:n=>e.tailRecM(a=>t.Bind1().bind(n(a))(o=>t.Applicative0().pure((()=>{if(o.tag==="Left")return pt("Done",d("Left",o._1));if(o.tag==="Right"){if(o._1.tag==="Loop")return pt("Loop",o._1._1);if(o._1.tag==="Done")return pt("Done",d("Right",o._1._1))}u()})()))),Monad0:()=>r}};var Ar=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)};return{throwError:r=>e.Applicative0().pure(d("Left",r)),Monad0:()=>t}};var ea={traverseWithIndex:e=>{let t=ea.Traversable2().sequence(e);return r=>{let n=ea.FunctorWithIndex0().mapWithIndex(r);return a=>t(n(a))}},FunctorWithIndex0:()=>ri,FoldableWithIndex1:()=>jr,Traversable2:()=>X};var Je=(e,t,r)=>({tag:e,_1:t,_2:r});var so=e=>{let t=e.Bind1().Apply0().Functor0(),r=a=>o=>i=>t.map(c=>{if(c.tag==="Left")return d("Left",c._1);if(c.tag==="Right")return d("Right",$(a(c._1._1),c._1._2));u()})(o(i)),n=X.traverse(z({Applicative0:()=>H(e),Bind1:()=>Z(e)}));return a=>o=>r(Td)(n(i=>{let c=i.pats;return r(_=>({pats:c,act:_}))(a(i.act))})(o))},Zd=e=>{let t=z({Applicative0:()=>H(e),Bind1:()=>Z(e)}),r=e.Bind1().Apply0().Functor0();return n=>{let a=n.traverse(t);return o=>a(i=>{let c=i.op,_=o(i.rhs);return l=>r.map(p=>{if(p.tag==="Left")return d("Left",p._1);if(p.tag==="Right")return d("Right",$({op:c,rhs:p._1._1},p._1._2));u()})(_(l))})}},Hd=e=>{let t=z({Applicative0:()=>H(e),Bind1:()=>Z(e)}),r=e.Bind1().Apply0().Functor0();return n=>{let a=n.traverse(t);return o=>a(i=>{let c=Id(i._1)(i._2),_=o(i._3);return l=>r.map(p=>{if(p.tag==="Left")return d("Left",p._1);if(p.tag==="Right")return d("Right",$(c(p._1._1),p._1._2));u()})(_(l))})}},po=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=Y(t),n=e.Bind1().Apply0().Functor0(),a=f=>D=>s=>n.map(S=>{if(S.tag==="Left")return d("Left",S._1);if(S.tag==="Right")return d("Right",$(f(S._1._1),S._1._2));u()})(D(s)),o=z(t),i=X.traverse(o),c=le(t),_=Hd(e)(X),l=X.traverse(o),p=Zd(e)(X),m=so(e);return f=>{let D=s=>{if(s.tag==="ExprList")return r.bind(a(za(s._1))(i(D)(s._2)))(f);if(s.tag==="ExprTuple")return r.bind(a(Ya(s._1))(i(D)(s._2)))(f);if(s.tag==="ExprFunc")return r.bind(a(Xa(s._1)(s._2))(D(s._3)))(f);if(s.tag==="ExprLet")return r.bind(c.apply(a(va(s._1)(s._2))(_(D)(s._3)))(D(s._4)))(f);if(s.tag==="ExprApp")return r.bind(r.bind(c.apply(a(Za(s._1))(D(s._2)))(l(D)(s._3)))(f))(f);if(s.tag==="ExprOperator")return r.bind(c.apply(a(Ha(s._1))(D(s._2)))(p(D)(s._3)))(f);if(s.tag==="ExprIf")return r.bind(c.apply(c.apply(a(to(s._1))(D(s._2)))(D(s._3)))(D(s._4)))(f);if(s.tag==="ExprParensed")return r.bind(a(no(s._1))(D(s._2)))(f);if(s.tag==="ExprTyped"){let S=s._1,g=s._3;return r.bind(a(I=>K("ExprTyped",S,I,g))(D(s._2)))(f)}return s.tag==="ExprMatch"?r.bind(c.apply(a(eo(s._1))(l(D)(s._2)))(m(D)(s._3)))(f):s.tag==="ExprMatchFn"?r.bind(a(ro(s._1)(s._2))(m(f)(s._3)))(f):f(s)};return D}},gs=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=z(t),n=Y(t),a=e.Bind1().Apply0().Functor0(),o=f=>D=>s=>a.map(S=>{if(S.tag==="Left")return d("Left",S._1);if(S.tag==="Right")return d("Right",$(f(S._1._1),S._1._2));u()})(D(s)),i=X.traverse(r),c=le(t),_=Hd(e)(X),l=X.traverse(r),p=Zd(e)(X),m=so(e);return f=>D=>s=>{let S=g=>{if(g.tag==="ExprConst")return r.pure(g);if(g.tag==="ExprIdent")return f(g._1)(g._2)(g._3);if(g.tag==="ExprList")return n.bind(o(za(g._1))(i(S)(g._2)))(s);if(g.tag==="ExprTuple")return n.bind(o(Ya(g._1))(i(S)(g._2)))(s);if(g.tag==="ExprFunc")return n.bind(o(Xa(g._1)(g._2))(S(g._3)))(s);if(g.tag==="ExprLet")return n.bind(c.apply(o(va(g._1)(g._2))(_(S)(g._3)))(S(g._4)))(s);if(g.tag==="ExprApp")return n.bind(n.bind(c.apply(o(Za(g._1))(S(g._2)))(l(S)(g._3)))(s))(s);if(g.tag==="ExprOperator")return n.bind(c.apply(o(Ha(g._1))(S(g._2)))(p(S)(g._3)))(s);if(g.tag==="ExprIf")return n.bind(c.apply(c.apply(o(to(g._1))(S(g._2)))(S(g._3)))(S(g._4)))(s);if(g.tag==="ExprParensed")return n.bind(o(no(g._1))(S(g._2)))(s);if(g.tag==="ExprTyped"){let I=g._1,b=g._3;return n.bind(o(T=>K("ExprTyped",I,T,b))(S(g._2)))(s)}if(g.tag==="ExprMatch")return n.bind(c.apply(o(eo(g._1))(l(S)(g._2)))(m(S)(g._3)))(s);if(g.tag==="ExprMatchFn")return n.bind(o(ro(g._1)(g._2))(m(s)(g._3)))(s);u()};return S}};var Ds=e=>{let t=At({Applicative0:()=>H(e),Bind1:()=>Z(e)});return r=>n=>a=>t.state(o=>$(void 0,{...o,env:{...o.env,types:Gt(Pa)(r)({kind:n,opened:!0,constrs:a})(o.env.types)}}))},hs=e=>{let t=At({Applicative0:()=>H(e),Bind1:()=>Z(e)});return r=>n=>a=>o=>t.state(i=>$(void 0,{...i,env:{...i.env,aliases:Gt(Wt(Br))(r)({realname:n,assoc:a,prec:o,opened:!0})(i.env.aliases)}}))},Ss=e=>{let t=At({Applicative0:()=>H(e),Bind1:()=>Z(e)});return r=>n=>t.state(a=>$(void 0,{...a,env:{...a.env,globals:Gt(Wn)(r)(n)(a.env.globals)}}))},Is=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=At(t).state(n=>$(n,n));return n=>Y(t).bind(r)(a=>z(t).pure(Vt(Wt(Be))(n)(a.env.types)))},Ts=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=At(t).state(n=>$(n,n));return n=>Y(t).bind(r)(a=>z(t).pure(R$(a.env)(n)))},Gs=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=At(t).state(n=>$(n,n));return n=>Y(t).bind(r)(a=>z(t).pure(dr(o=>o._1._2===n)(Jr(xr(Pa)(o=>i=>i.opened)(a.env.types)))))},ys=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=At(t).state(n=>$(n,n));return n=>Y(t).bind(r)(a=>z(t).pure(y$(n)(a.env)))},lo=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=At(t).state(n=>$(n,n));return n=>Y(t).bind(r)(a=>z(t).pure((()=>{let o=dr(i=>i._1._2===n)(Jr(xr(Wn)(i=>c=>c.opened)(a.env.globals)));if(o.tag==="Just")return o._1._2.desc.tag==="Constructor"?R("Just",o._1._2.desc._1):G;if(o.tag==="Nothing")return G;u()})()))},Xd=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=At(t).state(n=>$(n,n));return n=>Y(t).bind(r)(a=>z(t).pure((()=>{let o=Vt(Wt(oe))(n)(a.env.globals);if(o.tag==="Just")return o._1.desc.tag==="Constructor"?R("Just",o._1.desc._1):G;if(o.tag==="Nothing")return G;u()})()))};var Rs=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=z(t),n=Y(t),a=At(t),o=a.state(i=>$(i,i));return i=>{if(i<=0)return r.pure([]);let c=_=>l=>l===0?r.pure(_):n.bind(o)(p=>{let m=p.var;return n.bind(a.state(f=>$(void 0,{...f,var:m+1|0})))(()=>c(v(_)("v"+gt(m)))(l-1|0))});return c([])(i)}},fo=e=>{let t=e.Monad0(),r={Applicative0:()=>H(t),Bind1:()=>Z(t)};return Y(r).bind(Rs(t)(1))(n=>n.length===1?z(r).pure(n[0]):F("Impossible"))},Cs=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=Y(t),n=At(t);return r.bind(n.state(a=>$(a,a)))(a=>{let o=a.tvar;return r.bind(n.state(i=>$(void 0,{...i,tvar:o+1|0})))(()=>z(t).pure(E("TVar",{src:mr},"t"+gt(o))))})},an={loc:er},As=e=>{let t=e.Monad0(),r={Applicative0:()=>H(t),Bind1:()=>Z(t)},n=z(r),a=Y(r),o=fo(e);return po(t)(i=>{if(i.tag==="ExprFunc"){let c=i._1,_=i._3,l=p=>m=>{let f=ut(D=>G,D=>s=>R("Just",{head:D,tail:s}),m);if(f.tag==="Nothing")return n.pure(p);if(f.tag==="Just"&&f._1.head.tag==="PatTyped"&&f._1.head._2.tag==="PatVar")return l({...p,args:v(p.args)(f._1.head)})(f._1.tail);if(f.tag==="Just"&&f._1.head.tag==="PatVar")return l({...p,args:v(p.args)(f._1.head)})(f._1.tail);if(f.tag==="Just"){let D=f._1.head,s=f._1.tail;return a.bind(o)(S=>l({args:v(p.args)(Nt("PatVar",{loc:er},S)),matchHeads:v(p.matchHeads)(K("ExprIdent",{loc:er},G,S)),matchPats:v(p.matchPats)(D)})(s))}u()};return a.bind(l({args:[],matchHeads:[],matchPats:[]})(i._2))(p=>n.pure(K("ExprFunc",c,p.args.length>0?p.args:F("Impossible"),p.matchHeads.length>0?K("ExprMatch",(()=>{if(_.tag==="ExprConst"||_.tag==="ExprList"||_.tag==="ExprTuple"||_.tag==="ExprIdent"||_.tag==="ExprFunc"||_.tag==="ExprApp"||_.tag==="ExprOperator"||_.tag==="ExprLet"||_.tag==="ExprIf"||_.tag==="ExprMatch"||_.tag==="ExprMatchFn"||_.tag==="ExprTyped"||_.tag==="ExprParensed")return _._1;u()})(),p.matchHeads,[{act:_,pats:p.matchPats}]):_)))}return n.pure(i)})},bs=e=>{let t=e.Monad0(),r={Applicative0:()=>H(t),Bind1:()=>Z(t)},n=z(r).pure,a=Ts(t),o=lr(Ar(t)),i=t.Bind1().Apply0().Functor0(),c=_=>{if(_.tag==="Leaf")return _._2;if(_.tag==="Branch")return K("ExprApp",_._1,K("ExprIdent",{loc:_._2.op.at},R("Just",_._2.op.it.realname._1),_._2.op.it.realname._2),[c(_._2.lhs),c(_._2.rhs)]);u()};return gs(t)(_=>l=>p=>n(K("ExprIdent",_,l,p)))(n)(_=>{if(_.tag==="ExprOperator"){let l=yn(Yd(e)).tailRecM(p=>{let m=ut(f=>G,f=>D=>R("Just",{head:f,tail:D}),p._2);if(m.tag==="Nothing")return n(pt("Done",p._1));if(m.tag==="Just"){let f=m._1.head.op,D=m._1.tail,s=m._1.head.rhs;return Y(r).bind(a(f.it))(S=>{if(S.tag==="Nothing")return o.throwError(Ot("UnboundOperator",f.it));if(S.tag==="Just"){if(p._1.tag==="Leaf"){let g=(()=>{if(s.tag==="ExprConst"||s.tag==="ExprList"||s.tag==="ExprTuple"||s.tag==="ExprIdent"||s.tag==="ExprFunc"||s.tag==="ExprApp"||s.tag==="ExprOperator"||s.tag==="ExprLet"||s.tag==="ExprIf"||s.tag==="ExprMatch"||s.tag==="ExprMatchFn"||s.tag==="ExprTyped"||s.tag==="ExprParensed")return s._1;u()})();return n(pt("Loop",$(Je("Branch",{loc:{from:(()=>{if(p._1.tag==="Leaf"||p._1.tag==="Branch")return p._1._1.loc.from;u()})(),to:g.loc.to}},{op:{it:S._1,at:f.at},lhs:p._1,rhs:Je("Leaf",g,s)}),D)))}if(p._1.tag==="Branch"&&p._1._2.op.it.prec===S._1.prec&&(p._1._2.op.it.assoc==="RightAssoc"?S._1.assoc!=="RightAssoc":p._1._2.op.it.assoc==="LeftAssoc"?S._1.assoc!=="LeftAssoc":!(p._1._2.op.it.assoc==="NonAssoc"&&S._1.assoc==="NonAssoc")))return o.throwError(Ot("OperatorsAssociativityConflicts",[p._1._2.op,{it:S._1,at:f.at}]));if(p._1.tag==="Branch"){if(p._1._2.op.it.assoc==="LeftAssoc"&&S._1.assoc==="LeftAssoc"&&p._1._2.op.it.prec===S._1.prec||p._1._2.op.it.prec>S._1.prec){let I=(()=>{if(s.tag==="ExprConst"||s.tag==="ExprList"||s.tag==="ExprTuple"||s.tag==="ExprIdent"||s.tag==="ExprFunc"||s.tag==="ExprApp"||s.tag==="ExprOperator"||s.tag==="ExprLet"||s.tag==="ExprIf"||s.tag==="ExprMatch"||s.tag==="ExprMatchFn"||s.tag==="ExprTyped"||s.tag==="ExprParensed")return s._1;u()})();return n(pt("Loop",$(Je("Branch",{loc:{from:p._1._1.loc.from,to:I.loc.to}},{op:{it:S._1,at:f.at},lhs:p._1,rhs:Je("Leaf",I,s)}),D)))}let g=(()=>{if(s.tag==="ExprConst"||s.tag==="ExprList"||s.tag==="ExprTuple"||s.tag==="ExprIdent"||s.tag==="ExprFunc"||s.tag==="ExprApp"||s.tag==="ExprOperator"||s.tag==="ExprLet"||s.tag==="ExprIf"||s.tag==="ExprMatch"||s.tag==="ExprMatchFn"||s.tag==="ExprTyped"||s.tag==="ExprParensed")return s._1;u()})();return n(pt("Loop",$(Je("Branch",{loc:{from:p._1._1.loc.from,to:g.loc.to}},{...p._1._2,rhs:Je("Branch",{loc:{from:(()=>{if(p._1._2.rhs.tag==="Leaf"||p._1._2.rhs.tag==="Branch")return p._1._2.rhs._1.loc.from;u()})(),to:g.loc.to}},{op:{it:S._1,at:f.at},lhs:p._1._2.rhs,rhs:Je("Leaf",g,s)})}),D)))}}u()})}u()})($(Je("Leaf",(()=>{if(_._2.tag==="ExprConst"||_._2.tag==="ExprList"||_._2.tag==="ExprTuple"||_._2.tag==="ExprIdent"||_._2.tag==="ExprFunc"||_._2.tag==="ExprApp"||_._2.tag==="ExprOperator"||_._2.tag==="ExprLet"||_._2.tag==="ExprIf"||_._2.tag==="ExprMatch"||_._2.tag==="ExprMatchFn"||_._2.tag==="ExprTyped"||_._2.tag==="ExprParensed")return _._2._1;u()})(),_._2),_._3));return p=>i.map(m=>{if(m.tag==="Left")return d("Left",m._1);if(m.tag==="Right")return d("Right",$(c(m._1._1),m._1._2));u()})(l(p))}return n(_)})},ws=e=>{let t=e.Monad0(),r={Applicative0:()=>H(t),Bind1:()=>Z(t)},n=z(r),a=Y(r),o=fo(e),i=t.Bind1().Apply0().Functor0(),c=so(t),_=po(t),l=p=>{if(p.tag==="ExprMatchFn"){let m=p._1,f=p._3,D=s=>{let S=s._1,g=s._2;return I=>{let b=ut(T=>G,T=>M=>R("Just",{head:T,tail:M}),I);if(b.tag==="Nothing")return n.pure($(S,g));if(b.tag==="Just"){let T=b._1.head,M=b._1.tail;return a.bind(o)(h=>{let C={loc:er};return D($(v(S)(T.tag==="PatTyped"?Nt("PatTyped",T._1,Nt("PatVar",(()=>{if(T._2.tag==="PatWildcard"||T._2.tag==="PatVar"||T._2.tag==="PatConst"||T._2.tag==="PatTuple"||T._2.tag==="PatList"||T._2.tag==="PatConstructor"||T._2.tag==="PatAlias"||T._2.tag==="PatParensed"||T._2.tag==="PatTyped")return T._2._1;u()})(),h),T._3):Nt("PatVar",C,h)),v(g)(K("ExprIdent",C,G,h))))(M)})}u()}};return a.bind((()=>{let s=D($([],[]))(p._2);return S=>i.map(g=>{if(g.tag==="Left")return d("Left",g._1);if(g.tag==="Right")return d("Right",$(g._1._1._1.length>0&&g._1._1._2.length>0?$(g._1._1._1,g._1._1._2):F("Impossible"),g._1._2));u()})(s(S))})())(s=>{let S=s._1,g=s._2;return a.bind(c(_(l))(f))(I=>n.pure(K("ExprFunc",m,S,K("ExprMatch",m,g,I))))})}return n.pure(p)};return _(l)},Es=e=>{let t=e.Monad0(),r={Applicative0:()=>H(t),Bind1:()=>Z(t)},n=z(r),a=Y(r),o=fo(e);return po(t)(i=>{if(i.tag==="ExprLet"&&i._2==="NonRec"){let c=i._4,_=l=>{let p=ut(m=>G,m=>f=>R("Just",{head:m,tail:f}),l);if(p.tag==="Nothing")return n.pure(c);if(p.tag==="Just")return p._1.head._2.tag==="PatVar"?a.bind(_(p._1.tail))(m=>n.pure(K("ExprLet",an,Yr,[p._1.head],m))):a.bind(_(p._1.tail))(m=>a.bind(o)(f=>n.pure(K("ExprLet",an,Yr,[Qr(p._1.head._1,Nt("PatVar",an,f),p._1.head._3)],K("ExprMatch",an,[K("ExprIdent",an,G,f)],[{pats:[p._1.head._2],act:m}])))));u()};return _(i._3)}return n.pure(i)})},br=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=z(t),n=e.Bind1().Apply0().Functor0(),a=X.traverse(r),o=Y(t),i=Is(e),c=lr(Ar(e)),_=Gs(e);return l=>{if(l.tag==="TIdent"&&l._2.tag==="Nothing"&&ae(fe)(l._3)){let p=l._3;return o.bind(_(p))(m=>{if(m.tag==="Nothing")return c.throwError(Ot("UnboundTypeName",p));if(m.tag==="Just")return r.pure(E("TGlobal",{src:Re("User",l._1.loc)},m._1._1));u()})}if(l.tag==="TIdent"&&l._2.tag==="Nothing")return r.pure(E("TVar",{src:Re("User",l._1.loc)},l._3));if(l.tag==="TIdent"&&l._2.tag==="Just"&&ae(fe)(l._3))return o.bind(i(st(l._2._1,l._3)))(p=>{if(p.tag==="Just")return r.pure(E("TGlobal",{src:Re("User",l._1.loc)},st(l._2._1,l._3)));if(p.tag==="Nothing")return c.throwError(Ot("ModuleDoesNotExportName",l._2._1,l._3));u()});if(l.tag==="TTup"){let p=Bi({src:Re("User",l._1.loc)}),m=a(br(e))(l._2);return f=>n.map(D=>{if(D.tag==="Left")return d("Left",D._1);if(D.tag==="Right")return d("Right",$(p(D._1._1),D._1._2));u()})(m(f))}if(l.tag==="TFunc"){let p=l._2,m=f=>D=>{let s=ut(S=>G,S=>g=>R("Just",{head:S,tail:g}),D);if(s.tag==="Nothing")return r.pure(f);if(s.tag==="Just"){let S=s._1.tail;return o.bind(br(e)(s._1.head))(g=>m(v(f)(g))(S))}u()};return o.bind(br(e)(l._3))(f=>o.bind(m([])(p))(D=>r.pure(Tt(s=>S=>E("TFunc",(()=>{let g=(()=>{if(S.tag==="TGlobal"||S.tag==="TFunc"||S.tag==="TTup"||S.tag==="TVar")return S._1.src;u()})(),I=(()=>{if(s.tag==="TGlobal"||s.tag==="TFunc"||s.tag==="TTup"||s.tag==="TVar")return s._1.src;u()})();return I.tag==="User"?g.tag==="User"?{src:Re("User",{from:I._1.from,to:g._1.to})}:g.tag==="Compiler"?{src:Re("User",I._1)}:{src:mr}:I.tag==="Compiler"&&g.tag==="User"?{src:Re("User",g._1)}:{src:mr}})(),s,S))(f)(D))))}return F("Not implemented")}},Ms=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=z(t),n=lr(Ar(e)),a=e.Bind1().Apply0().Functor0(),o=D=>s=>S=>a.map(g=>{if(g.tag==="Left")return d("Left",g._1);if(g.tag==="Right")return d("Right",$(D(g._1._1),g._1._2));u()})(s(S)),i=X.traverse(r),c=le(t),_=br(e),l=Y(t),p=lo(e),m=Xd(e),f=D=>{if(D.tag==="PatWildcard")return r.pure(it("PatWildcard",D._1));if(D.tag==="PatConst")return r.pure(it("PatConst",D._1,D._2));if(D.tag==="PatVar")return r.pure(it("PatVar",D._1,D._2));if(D.tag==="PatList")return n.throwError(Ot("NotSupportedYet","List pattern"));if(D.tag==="PatTuple")return o(Z$(D._1))(i(f)(D._2));if(D.tag==="PatConstructor"&&ae(fe)(D._3)){let s=D._3;return l.bind((()=>{if(D._2.tag==="Nothing")return p(s);if(D._2.tag==="Just")return m(st(D._2._1,s));u()})())(S=>{if(S.tag==="Nothing")return n.throwError(Ot("UnknownConstructor",D._2,s));if(S.tag==="Just"){let g=S._1;return l.bind(Nr.traverse(r)(f)(D._4))(I=>{if(I.tag==="Just"&&I._1.tag==="PatTuple")return r.pure(it("PatConstructor",D._1,g.typname,g.tag,I._1._2));if(I.tag==="Just")return r.pure(it("PatConstructor",D._1,g.typname,g.tag,[I._1]));if(I.tag==="Nothing")return r.pure(it("PatConstructor",D._1,g.typname,g.tag,[]));u()})}u()})}if(D.tag==="PatConstructor")return n.throwError(Ot("NotAConstructor",G,D._3));if(D.tag==="PatTyped")return c.apply(o(X$(D._1))(f(D._2)))(_(D._3));if(D.tag==="PatAlias")return c.apply(o(H$(D._1))(f(D._2)))(r.pure(D._3));if(D.tag==="PatParensed")return f(D._2);u()};return f},Ls=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=z(t),n=Y(t),a=br(e),o=lo(e),i=Xd(e),c=lr(Ar(e)),_=ys(e),l=e.Bind1().Apply0().Functor0(),p=I=>b=>T=>l.map(M=>{if(M.tag==="Left")return d("Left",M._1);if(M.tag==="Right")return d("Right",$(I(M._1._1),M._1._2));u()})(b(T)),m=X.traverse(r),f=le(t),D=Ms(e),s=I=>{if(I.tag==="ExprConst")return r.pure(J("ExprConst",I._1,I._2));if(I.tag==="ExprIdent"){if(ae(fe)(I._3)){let M=I._1,h=I._3,C=I._2;return n.bind((()=>{if(C.tag==="Nothing")return o(h);if(C.tag==="Just")return i(st(C._1,h));u()})())(N=>{if(N.tag==="Nothing")return c.throwError(Ot("UnknownConstructor",C,h));if(N.tag==="Just"&&N._1.argTypes.length===0)return r.pure(J("ExprConstructor",M,N._1.name,[]));if(N.tag==="Just")return r.pure(J("ExprGlobal",M,N._1.name));u()})}let b=I._1,T=I._3;return n.bind(_(T))(M=>{if(M.tag==="Nothing")return r.pure(J("ExprVar",b,T));if(M.tag==="Just")return r.pure(J("ExprGlobal",b,M._1._1));u()})}if(I.tag==="ExprList")return c.throwError(Ot("NotSupportedYet","list"));if(I.tag==="ExprTuple")return p(v$(I._1))(m(s)(I._2));if(I.tag==="ExprFunc"){let b=I._1;return n.bind(s(I._3))((()=>{let T=I._2;return M=>{let h=C=>N=>{let y=ut(U=>G,U=>Q=>R("Just",{head:U,tail:Q}),N);if(y.tag==="Nothing")return r.pure(Tt((()=>{let U=td(b);return Q=>U(Q._1)(Q._2)})())(M)(C));if(y.tag==="Just"){if(y._1.head.tag==="PatTyped"&&y._1.head._2.tag==="PatVar"){let U=y._1.head._2._2;return n.bind(a(y._1.head._3))(Q=>h(v(C)($({it:U,at:y._1.head._1.loc},R("Just",Q))))(y._1.tail))}return y._1.head.tag==="PatTyped"?F("Impossible"):y._1.head.tag==="PatVar"?h(v(C)($({it:y._1.head._2,at:y._1.head._1.loc},G)))(y._1.tail):F("Impossible")}u()};return h([])(T)}})())}return I.tag==="ExprApp"?n.bind(s(I._2))(g(I._1)(I._3)):I.tag==="ExprTyped"?f.apply(p(ad(I._1))(s(I._2)))(a(I._3)):I.tag==="ExprLet"&&I._2==="NonRec"&&I._3.length===1&&I._3[0]._2.tag==="PatVar"?f.apply(p(ed(I._3[0]._1)({it:I._3[0]._2._2,at:I._3[0]._2._1.loc}))(s(I._3[0]._3)))(s(I._4)):I.tag==="ExprLet"?I._2==="NonRec"?F("Impossible"):F("Not implemented"):I.tag==="ExprIf"?f.apply(f.apply(p(rd(I._1))(s(I._2)))(s(I._3)))(s(I._4)):I.tag==="ExprParensed"?s(I._2):I.tag==="ExprOperator"?F("Imposible"):I.tag==="ExprMatchFn"?F("Impossible"):I.tag==="ExprMatch"?p(nd(I._1))(S(I._2)(I._3)):F("Not implemented")},S=I=>b=>n.bind(m(s)(I))(T=>n.bind(m(M=>n.bind(m(D)(M.pats))(h=>n.bind(s(M.act))(C=>r.pure({pats:h,act:C}))))(b))(M=>r.pure({heads:T,matrix:M}))),g=I=>b=>T=>{let M=h=>C=>{let N=ut(y=>G,y=>U=>R("Just",{head:y,tail:U}),C);if(N.tag==="Nothing")return r.pure(h);if(N.tag==="Just"){let y=N._1.tail;return n.bind(s(N._1.head))(U=>n.bind(h.tag==="ExprGlobal"?n.bind(i(h._2))(Q=>{if(Q.tag==="Just")return U.tag==="ExprTuple"?r.pure(J("ExprConstructor",(()=>{if(h.tag==="ExprConst"||h.tag==="ExprVar"||h.tag==="ExprGlobal"||h.tag==="ExprTuple"||h.tag==="ExprField"||h.tag==="ExprConstructor"||h.tag==="ExprFunc"||h.tag==="ExprApp"||h.tag==="ExprLet"||h.tag==="ExprIf"||h.tag==="ExprMatch"||h.tag==="ExprTyped")return h._1;u()})(),Q._1.name,U._2)):r.pure(J("ExprConstructor",(()=>{if(h.tag==="ExprConst"||h.tag==="ExprVar"||h.tag==="ExprGlobal"||h.tag==="ExprTuple"||h.tag==="ExprField"||h.tag==="ExprConstructor"||h.tag==="ExprFunc"||h.tag==="ExprApp"||h.tag==="ExprLet"||h.tag==="ExprIf"||h.tag==="ExprMatch"||h.tag==="ExprTyped")return h._1;u()})(),Q._1.name,[U]));if(Q.tag==="Nothing")return r.pure(J("ExprApp",I,h,U));u()}):r.pure(J("ExprApp",I,h,U)))(Q=>M(Q)(y)))}u()};return M(T)(b)};return s},Ps=e=>{let t={Applicative0:()=>H(e),Bind1:()=>Z(e)},r=z(t),n=Cs(e);return yt.traverse(r)(a=>Y(t).bind(n)((()=>{let o=id(a.loc);return i=>r.pure(o(i))})()))},Ns=e=>{let t=e.Monad0(),r=Y({Applicative0:()=>H(t),Bind1:()=>Z(t)}),n=As(e),a=ws(e),o=(()=>{let i=Es(e),c=(()=>{let _=bs(e),l=(()=>{let p=Ls(t),m=(()=>{let f=Ps(t);return D=>r.bind(p(D))(f)})();return f=>r.bind(_(f))(m)})();return p=>r.bind(i(p))(l)})();return _=>r.bind(a(_))(c)})();return i=>r.bind(n(i))(o)},vd=e=>{let t=e.Monad0(),r=t.Bind1().Apply0().Functor0(),n=g=>I=>b=>r.map(T=>{if(T.tag==="Left")return d("Left",T._1);if(T.tag==="Right")return d("Right",$(g(T._1._1),T._1._2));u()})(I(b)),a={Applicative0:()=>H(t),Bind1:()=>Z(t)},o=z(a),i=X.traverse(o),c=Y(a),_=Ns(e),l=Ss(t),p=lr(Ar(t)),m=lo(t),f=br(t),D=ea.traverseWithIndex(o),s=Ds(t),S=hs(t);return g=>{let I=wn(g.name);return c.bind(n(mn)(i(b=>{if(b.tag==="DeclAlias"){let T=b._4.it,M=b._1.loc,h=b._5.it,C=st(g.name,b._2.it),N=st(g.name,b._3.it);return c.bind(S(N)(C)(T)(h))(()=>o.pure(R("Just",{loc:M,opname:N,realname:C,assoc:T,prec:h})))}return o.pure(G)})(g.decls)))(b=>n(od)(le(a).apply(n(T=>M=>({name:g.name,loc:g.loc,operators:b,decls:M,typeDecls:T}))(n(mn)(i(T=>{let M=h=>T.tag==="DeclSet"?p.throwError(Ot("InvalidTypName",T._2.at,T._2.it)):o.pure(G);if(T.tag==="DeclSet"){let h=ae(fe)(T._2.it)?R("Just",T._2.it):G;if(h.tag==="Just"){let C=I(h._1);return c.bind(D(N=>y=>{let U=(()=>{if(y.tag==="ConstrNull"||y.tag==="ConstrStructured")return y._2;u()})(),Q=ae(fe)(U.it)?R("Just",U.it):G;if(Q.tag==="Nothing")return p.throwError(Ot("InvalidConstructorName",U.at,U.it));if(Q.tag==="Just"){let he=Q._1;return c.bind((()=>{let qt=(Ue,te,Ee)=>{if(ae(fe)(te.it)){let $e=te.it;return c.bind(m($e))(e_=>e_.tag==="Just"?p.throwError(Ot("ConstructorNameConflicts",te.at,$e)):o.pure({name:I($e),typname:C,tag:N,argTypes:Ee}))}return p.throwError(Ot("InvalidConstructorName",te.at,te.it))};if(y.tag==="ConstrNull")return qt(y._1,y._2,[]);if(y.tag==="ConstrStructured"){let Ue=y._1,te=y._2;return c.bind(f(y._3))(Ee=>Ee.tag==="TTup"?qt(Ue,te,j(Ce.map($e=>{}))(Ee._2)):qt(Ue,te,[Ce.map($e=>{})(Ee)]))}u()})())(qt=>c.bind(l(I(he))({opened:!0,desc:Bt("Constructor",qt),typ:E("TGlobal",void 0,qt.typname)}))(()=>o.pure(qt)))}u()})(T._3))(N=>c.bind(s(C)(gr(void 0))(j(y=>y.name)(N)))(()=>o.pure(R("Just",{loc:T._1.loc,typname:C,kind:gr(void 0),constrs:re(y=>U=>({name:U.name,tag:y,argTypes:U.argTypes}))(N)}))))}}return M(!0)})(g.decls))))(n(mn)(i(T=>{if(T.tag==="Decl"){let M=T._2;return c.bind(T._3.length>0?_(K("ExprFunc",{loc:{from:M.at.from,to:T._1.loc.to}},T._3,T._4)):_(T._4))(h=>c.bind(l(I(M.it))({desc:Bt("Normal",{}),typ:Ce.map(C=>{})((()=>{if(h.tag==="ExprConst"||h.tag==="ExprVar"||h.tag==="ExprGlobal"||h.tag==="ExprTuple"||h.tag==="ExprField"||h.tag==="ExprConstructor"||h.tag==="ExprFunc"||h.tag==="ExprApp"||h.tag==="ExprLet"||h.tag==="ExprIf"||h.tag==="ExprMatch"||h.tag==="ExprTyped")return h._1._2;u()})()),opened:!0}))(()=>o.pure(R("Just",Y$("NonRec",{ident:M,expr:h})))))}return o.pure(G)})(g.decls)))))}};function mo(e){return new ArrayBuffer(e)}var t_=(e,t)=>({tag:e,_1:t}),qs=vd(un),ks=(()=>{let e=ld(_a);return t=>r=>e(r)({genv:t})({locals:Fa})})(),hS=e=>t_("InpString",e),SS=e=>t_("InpFile",e),Ws=e=>{let t=Vd("Sample")(e);if(t.tag==="Left"){let r=d("Left",(()=>{if(t._1.desc.tag==="LexUnexpected")return`An error has occurred during parsing:
  Unexpected input: `+t._1.desc._1;if(t._1.desc.tag==="UnexpectedToken")return`An error has occurred during parsing:
  Unexpected token: `+Gd(t._1.desc._1);u()})());return()=>r}if(t.tag==="Right"){let r=qs(t._1)({tvar:0,var:0,env:q$});if(r.tag==="Left"){let n=d("Left",(()=>{if(r._1.tag==="UnboundOperator")return`An error has occurred during well-formedness cheking:
  Unbound operator: `+r._1._1;if(r._1.tag==="UnboundName")return`An error has occurred during well-formedness cheking:
  Unbound name: `+r._1._1;if(r._1.tag==="UnboundTypeName")return`An error has occurred during well-formedness cheking:
  Unbound type name: `+r._1._1;if(r._1.tag==="NotAConstructor")return`An error has occurred during well-formedness cheking:
  Not a valid constructor name: `+r._1._2;if(r._1.tag==="UnknownConstructor")return`An error has occurred during well-formedness cheking:
  Unknown constructor name: `+r._1._2;if(r._1.tag==="InvalidTypName")return`An error has occurred during well-formedness cheking:
  Invalid type name: `+r._1._2;if(r._1.tag==="InvalidConstructorName")return`An error has occurred during well-formedness cheking:
  Invalid constructor name: `+r._1._2;if(r._1.tag==="ModuleDoesNotExportName")return`An error has occurred during well-formedness cheking:
  The Module `+r._1._1+" does not export "+r._1._2;if(r._1.tag==="NotSupportedYet")return`An error has occurred during well-formedness cheking:
  I'm VERRRY sorry, but the feature `+r._1._1+" is not supported yet.";if(r._1.tag==="OperatorsAssociativityConflicts")return`An error has occurred during well-formedness cheking:
  The operator associativity conflicts.`;if(r._1.tag==="ConstructorNameConflicts")return`An error has occurred during well-formedness cheking:
  Constructor name conflicts`;u()})());return()=>n}if(r.tag==="Right"){let n=ks(r._1._2.env)(r._1._1);return()=>{let a=n();return d("Right",{dasmText:()=>"program",emitBin:bi(Ai(l$(a._1)))})}}}u()},IS=e=>{let t=Ws(e);return()=>{let r=t();if(r.tag==="Left")return{success:!1,error:r._1,output:()=>mo(0)};if(r.tag==="Right")return{success:!0,error:null,output:r._1.emitBin};u()}};export{t_ as $CompileInput,SS as InpFile,hS as InpString,qs as checkModule,Ws as compile,IS as compileJs,ks as translate};
